(sec-visualization-analytics-design)=
# 可视化设计

在前面的小节里，我们聚焦于可视分析的核心概念与技术实现。
从多视图联动到人机协同，从数据处理到可视编码，在可视分析的框架下，我们更深入地理解了可视化在面对复杂数据、多重任务以及高层洞察时所能发挥的作用。
然而，无论是科学可视化、信息可视化，还是可视分析，背后都离不开一整套贯穿各阶段的可视化设计与评估方法。
接下来将针对设计与评估这一通用需求进行系统梳理，使读者能够在不同场景下为可视化任务选取恰当的方案，并通过科学的评估手段验证其有效性与可用性。

## 可视化流程

常见的可视化设计流程通常包括以下几个主要阶段。具体实现时，这些阶段往往会迭代交替或并行推进，而非严格线性顺序。

**1. 需求分析**

- 用户目标与任务梳理：首先需要明确“谁”在使用可视化，“用它来做什么”，“要完成哪些具体任务”。不同的用户群体（如数据科学家、商业分析师、公众等）在可视化需求上可能有极大的差异。只有充分理解他们的目标与使用场景，才能让设计更加贴合实际。
- 数据特征确认：分析数据来源、数据类型（数值型、分类型、时序、地理空间、多维度等）、数据规模与质量，以及可能带来的挑战或异常（缺失值、噪声、偏差等）。

**2. 数据与任务匹配**

数据预处理与整理：在设计图形表达之前，需要对原始数据进行清洗、聚合、转化或编码等。如果有特定的分析需求，还可能进行降维、聚类或其他统计加工。
明确可视化任务类型：根据具体应用场景，可以将任务分为概览（overview）、筛选（filter）、详情（details on demand）、比较（comparison）以及发现模式（pattern discovery）或归纳推断（inference）等。
著名的 Shneiderman’s Mantra（Overview first, zoom/filter, then details-on-demand）{cite}`shneiderman2003eyes`便是对这一逻辑的典型诠释。

**3. 视觉编码与布局**

- 选择恰当的图形类型：根据数据类型与要表达的关系，决定使用点图、线图、柱状图、散点图、树状图、网络图、地理可视化等；
- 视觉编码原则：颜色、大小、形状、位置、纹理等视觉通道要与数据属性相匹配；避免不当使用视觉编码导致混淆或误解。
- 布局策略：对多维或非线性结构的数据进行合理布局，如层次布局、力导向布局、地理投影等，并结合对比视图或小多视图的方式来展示多重信息。

**4. 交互与反馈设计**

- 交互目标：帮助用户在可视化中快速定位信息、调整数据视角或过滤条件；
- 交互类型：缩放与平移、刷选（Brushing）、联动（Linking）、鼠标悬停提示（Tooltip）、拖拽、菜单选择等；
- 反馈与状态提示：当用户完成操作时，系统需要在视觉上及时给予反馈（如视图高亮、弹出信息框），让用户明了当前的浏览焦点、过滤条件或选择状态。

**5. 迭代与评估**

- 原型测试与用户反馈：可以采用快速原型（纸笔草图或低保真 Demo）获得初步反馈，并不断改善视觉编码或交互方案；
- 量化与质性评估：收集用户的任务完成时间、正确率、使用体验访谈等信息，分析可视化的易用性和有效性。
- 部署与维护：若是需要长期使用的可视化系统，还需要考虑后续的数据更新、用户培训、功能扩展等维护工作。

可视化设计的流程与上一章可视分析的步骤既有交叉又各自侧重。
与可视分析流程围绕“发现与决策”，更多体现可视化在数据分析与决策场景中的深度应用不同，可视化设计的流程则是与工具和界面开发紧密结合的实践指南，帮助用户从如何设计一幅好图或一套可视化系统的角度来思考和落实具体方案。
换言之，它是一种更通用、更面向各类可视化产品开发的设计指导，更强调从项目初始到完成，一步步去构建一个“好的图形/界面/视觉表达”。

## 可视化设计原则


在遵循设计流程的同时，相关的基本原则则为每个阶段提供方法论和思维指引。以下原则常被广泛引用或验证，能有效提升可视化的可读性、易用性以及表现力：

**1. 准确性**

可视化需要如实、准确地反映数据本质，避免歪曲或误导信息。
避免使用不合适的坐标区间（如截断坐标轴、不恰当的比例、夸大差异）或错误的视觉映射（不合适的图表类型）；
若数据存在不确定性，需要在可视化中明确标记或提示（如置信区间、误差线）；

如{numref}`fig-visualization-analytics-wrong_block` 所示，这里的三维图形就造成了遮挡。

```{figure} fig/visualization-analytics-wrong_block.png
:name: fig-visualization-analytics-wrong_block
三维图形会造成遮挡。
```

**2. 简洁性**

追求在有限的视觉空间内最大限度地传递关键信息，避免过度装饰或不必要图形元素带来的视觉噪音。
采用“最小但充分”的视觉表达方式，凸显数据核心；
“少即是多”的设计理念，去冗余、去复杂，让读者聚焦于数据本身。
如{numref}`fig-visualization-analytics-wrong_redundant` 所示，单个可视化文件中包含过多数据会给观看者带来难以聚焦的问题。

```{figure} fig/visualization-analytics-wrong_redundant.png
:name: fig-visualization-analytics-wrong_redundant
单个可视化文件中包含过多数据会令观看者不知所措。
```

**3. 一致性**
统一的设计风格和编码规约能帮助用户快速建立认知模型。
在多个视图或多个版本中保持相同的色彩编码、轴度量和符号，避免用户在不同图表之间产生混淆；
交互控件（如按钮、下拉菜单、滤镜）也应保持统一的外观与位置，提升学习和使用效率。

**4. 可对比性**
可视化执行的常见任务之一是“比较”（Comparison），如比较不同分类、不同时间点、不同维度间的差异。
在设计时，要注意对齐相同量程的轴刻度、使用相同配色或相同标记方式；
若数据规模或数量级差异过大，可使用对数坐标或其他技术来保持视觉上的可比性。

**5. 可探索性**
为用户提供多种探索路径，通过交互与多视图联动的机制实现深层次分析。
允许用户动态筛选、聚焦或切换数据维度；
视图间联动有助于在不同角度、不同聚合层次下快速观察数据模式。

**6. 面向任务**
不同的分析目标需要不同的可视化方式。要始终围绕任务需求选择图表形式和交互手段。
任务若以发现趋势为主，可重点考虑时间序列可视化或流图；
任务若侧重对比和分类，可以采用坐标轴对齐、雷达图或并列式可视化；
若是地理空间任务，则离不开地图投影、行政区划等地理可视化元素。

**7. 感知与认知匹配**
人眼对于空间位置、长度和角度相比颜色或面积更敏感；对色度变化的辨别受限于个人经验及设备差异（显示器或打印机色彩）。
优先利用位置、长度或角度等人类最敏感的视觉通道表达重要信息；
要考虑色弱、色盲或其他认知障碍人群的识别难度，提供颜色高对比度或可自定义调色板等选项。


**8. 上下文与引导**
在可视化中，适当提供标题、图例、标注、辅助线、说明性文字等。
说明可视化的对象、度量单位、数据来源或参考基线，避免用户产生误解；
引导用户如何使用或阅读图表，让初学者能更快上手。



## 常见的可视化图表及工具库

### 图表

有许多可视化工具可供选择，具体取决于数据类型和可视化需求。以下是一些常见的可视化图表类型：

- 条形图和柱状图：用于比较不同类别的数据，如{numref}`fig-visualization-analytics-popularity`。
  - 适用数据类型：离散型或分类型数据（如不同城市、产品、月份等）；也可用于数量级对比（如销售额对比）。
  - 优点：易于理解、对比效果好；
  - 注意：横向柱状图在类别较多或类名过长时更可读。

```{figure} fig/visualization-analytics-popularity.png
:name: fig-visualization-analytics-popularity
世界人口数量条形图。 ©Apache ECharts
```
- 折线图：用于显示数据随时间变化的趋势，如{numref}`fig-visualization-analytics-aqi`。
  - 适用数据类型：连续型数据（如时间序列、温度变化、收益率等）。
  - 优点：展现趋势、峰值、波动等特征；
  - 注意：对比多条折线时，应区分颜色或线型，避免信息混淆。

```{figure} fig/visualization-analytics-aqi.png
:name: fig-visualization-analytics-aqi
空气质量折线图。 ©Apache ECharts
```

- 散点图：用于显示两个变量之间的关系，如{numref}`fig-visualization-analytics-gender`。
  - 适用数据类型：需要观察“数值型数据之间的分布与关联度”的场合。
  - 优点：直观识别集群、离群点、线性/非线性关系；
  - 扩展：气泡图 (Bubble Chart) 可在散点图中用圆大小或颜色表达第三个维度
```{figure} fig/visualization-analytics-gender.png
:name: fig-visualization-analytics-gender
男女身高体重分布图。
```

- 饼图：用于显示数据的组成部分，如{numref}`fig-visualization-analytics-pie`。
  - 适用数据类型：少量分类（通常不超过5～7个），占比含义明显。
  - 优点：直观展示占比关系；
  - 缺点：当分类过多或数值差异不大时，不易比较；易失真。

```{figure} fig/visualization-analytics-pie.png
:name: fig-visualization-analytics-pie
饼状图。
```
- 雷达图：用多条轴从中心发散，用于比较多个变量之间的关系。
  - 适用数据类型：需要对多个维度指标进行综合对比；适合少量对象之间的“能力雷达”对比。
  - 优点：在有限平面内展现多维度，直观对比不同对象的“形状差异”；
  - 缺点：对比多对象时易重叠混乱；维度间的定量对比不如柱状图直观。

- 热力图：通过色块深浅、色彩来表示数据的密度和分布；常用于矩阵或地理分布场景。
  - 适用数据类型：密集型二维或地理空间数据。
  - 优点：一目了然地呈现“热点”“聚集区”；
  - 注意：需要色彩梯度合理，确保用户能辨别数值变化区间。

- 箱线图：显示数据的分布、离散程度、中位数、上下四分位等统计信息。
  - 适用数据类型：连续性或数值型数据，常对比不同分组的分布特征。
  - 优点：捕捉数据异常值、偏度及整体分布状况；
  - 缺点：对较少数据可能表达不足，通常适用于大样本量。

- 树状图：用于展示层级数据或有“部分-整体”关系的数据（如分层资产、分类目录等），如{numref}`fig-visualization-analytics-income`。 
  - 适用数据类型：层级结构下不同类别的占比、分布。
  - 优点：紧凑展示大量层级信息；
  - 缺点：当层级过深或类别差异不明显时，阅读成本上升。

```{figure} fig/visualization-analytics-income.png
:name: fig-visualization-analytics-income
工资使用情况图。 ©Reddit
```

- 网络图：展示数据实体之间的关系结构、节点连接和群落，如{numref}`fig-visualization-analytics-congress`。
  - 适用数据类型：社交关系、引用关系、知识图谱等表现复杂网络的场景。
  - 优点：直观反映关系拓扑结构；
  - 缺点：当节点数过多时，画面会显得杂乱，需要聚合或交互手段。

```{figure} fig/visualization-analytics-congress.png
:name: fig-visualization-analytics-congress
美国国会议员路径图。 ©The New York Times
```

### 工具库

学习可视化最好的方法是实际操作。使用真实数据集创建可视化，尝试不同的图形类型和设计选择，以提高可视化技能。
下面介绍一些流行度较高的前端可视化库和部分桌面工具，帮助读者根据需求快速做出选择。

**1. 前端可视化库**

- D3.js

特点：功能强大、灵活度高，可以实现定制化图表和各种交互。

适用场景：学术研究、创新型可视化项目；需要精准控制DOM、SVG或Canvas。

- Chart.js / Chartist.js / ApexCharts / Recharts

特点：提供常用图表（柱状图、饼图、折线图、散点图等），上手简单。

适用场景：快速构建基础可视化场景，中小型项目或移动端仪表盘。

- Three.js

特点：专注 3D 渲染，可与 D3.js 或 ECharts 结合实现 3D 可视化。

适用场景：需要 3D 地图、模型、空间感强的可视化（VR/AR 应用）。

- Matplotlib

特点：功能全面且灵活，能够绘制非常丰富的 2D 图表且生态成熟。

适用场景：科研、工程中常见的基础绘图以及需要高度自定义或者与 NumPy、Pandas 深度结合的应用场景。

- Seaborn

特点：基于 Matplotlib 的高级接口，绘图语法更简洁、风格更美观，内置许多统计学可视化。

适用场景：统计分析和数据探索以及美观可视化的快速获得。


**2. 桌面工具与可视化分析平台**

- Tableau

特点：商业软件，拖拽式操作，支持多维数据探索和仪表盘搭建，功能强大。

适用场景：企业级数据分析、商业BI、交互式报表。

- Power BI

特点：微软推出的商业分析工具，与 Office 生态结合紧密；

适用场景：企业内部数据分析、BI 报告；

- QlikView / Qlik Sense

特点：支持内存计算引擎，能够处理较大规模数据量；

适用场景：大数据环境下的商业分析场景；

- Google Data Studio / Looker Studio

特点：谷歌免费可视化报告平台，深度整合 Google Analytics 等产品；

适用场景：个人或中小企业的网络营销数据分析、SEO报告、仪表盘展示等；

**3. 如何根据数据类型和需求选择合适工具**

- 明确数据规模与类型

规模较小、以表格化数据为主：桌面工具 (如 Excel、Google Sheets) 就足够应对基本需求；

中型数据量、需常规图表和交互报表：Chart.js、ECharts、Power BI 等；

大规模数据、多维且需要复杂分析：Tableau、Qlik 等商业工具，或者基于 D3.js 的自定义开发。

- 考虑可视化目标与场景

企业级报告或仪表盘场景：Power BI、Tableau、ECharts 配合后端数据交互；

学术或创新项目，定制化要求高：D3.js 或 Three.js，灵活度更高，但开发量较大；

营销汇报、用户行为分析：Google Data Studio、Looker Studio；

- 评估团队技能与时间成本

快速原型或无专业开发队伍：Tableau、Power BI、Google Data Studio 常是首选；

有专业前端开发能力，追求个性化*：D3.js、Three.js、ECharts 二次开发；

已有后端/BI 基础，想统一管理权限与数据：Power BI、Qlik、Tableau 集成效果更好。

- 兼顾平台兼容与可持续性

大部分前端可视化库都基于 HTML5/JavaScript，可在各种浏览器运行，适合多端部署；

桌面工具有时需要安装客户端或许可证，务必确认对操作系统、版本号以及后续升级的兼容性；

若需求持续演变，要考虑后续维护成本、扩展性以及对团队培训的投入。
