
<!DOCTYPE html>


<html lang="zh-CN" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>21.2. 有限元方法 &#8212; 可视计算与交互概论</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=051c1eab"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/translations.js?v=beaddf03"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'animation/elastomers/fem';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="21.3. 本章小结" href="summary.html" />
    <link rel="prev" title="21.1. 弹簧质点系统" href="mass-spring.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="zh-CN"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">跳转至主要内容</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>回到顶部</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="版本警告"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">可视计算与交互概论</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">搜索</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">1. 引言</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">I. 入门：二维图形</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/basics/index.html">2. 二维图形基础</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/basics/pixel-vector.html">2.1. 像素与矢量</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/basics/hardware.html">2.2. 显示原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/basics/summary.html">2.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/color/index.html">3. 颜色</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/color/color-physics.html">3.1. 颜色的物理与感知</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/color/color-representation.html">3.2. 颜色的离散表示</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/color/color-display.html">3.3. 颜色显示</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/color/color-psychology.html">3.4. 颜色感知与心理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/color/summary.html">3.5. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/drawing-2d/index.html">4. 绘图</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/drawing-2d/rasterization.html">4.1. 光栅化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/drawing-2d/polygon.html">4.2. 多边形</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/drawing-2d/composition.html">4.3. 合成</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/drawing-2d/summary.html">4.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/anti-aliasing/index.html">5. 反走样</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/anti-aliasing/signal-theory.html">5.1. 信号理论</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/anti-aliasing/aa-principle.html">5.2. 反走样</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/anti-aliasing/summary.html">5.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/curves/index.html">6. 曲线</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/curves/curve-basic.html">6.1. 曲线数学基础</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/curves/curve-spline.html">6.2. 样条曲线</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/curves/curve-bezier.html">6.3. 贝塞尔曲线</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/curves/curve-rasterization.html">6.4. 曲线光栅化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/curves/summary.html">6.5. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/images/index.html">7. 图像处理</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/images/filtering.html">7.1. 图像滤波</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/images/poisson.html">7.2. 图像补全与融合</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/images/segmentation.html">7.3. 图像分割与抠图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/images/dithering.html">7.4. 图像抖动</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/images/seam.html">7.5. 图像缩放</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/images/summary.html">7.6. 本章小结</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">II. 几何建模</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../geometry/basics/index.html">8. 几何建模基础</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/basics/representation.html">8.1. 几何形状的表示方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/basics/model.html">8.2. 几何形状的建模</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/basics/display.html">8.3. 几何形状的显示</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/basics/summary.html">8.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../geometry/representation/index.html">9. 几何表达</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/representation/mesh.html">9.1. 网格表示</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/representation/voxel-and-point-cloud.html">9.2. 体素和点云表示</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/representation/implicit-field.html">9.3. 隐式表达</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/representation/summary.html">9.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../geometry/reconstruction/index.html">10. 几何重建</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/reconstruction/point-cloud.html">10.1. 点云的获取与配准</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/reconstruction/surface.html">10.2. 点云的表面重建</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/reconstruction/fit.html">10.3. 点云的模型拟合</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/reconstruction/summary.html">10.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../geometry/processing/index.html">11. 几何处理</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/processing/ddg.html">11.1. 离散微分几何</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/processing/smoothing.html">11.2. 网格平滑</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/processing/simplification.html">11.3. 网格简化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/processing/subdivision.html">11.4. 网格细分</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/processing/editing.html">11.5. 网格编辑</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/processing/summary.html">11.6. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../geometry/transformation/index.html">12. 几何变换</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/transformation/2d.html">12.1. 二维几何变换</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/transformation/3d.html">12.2. 三维几何变换</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/transformation/system.html">12.3. 坐标系变换</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/transformation/projection.html">12.4. 投影变换</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/transformation/summary.html">12.5. 本章小结</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">III. 渲染</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../rendering/basics/index.html">13. 渲染基础</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/basics/context.html">13.1. 渲染的定义与发展</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/basics/description.html">13.2. 渲染场景的描述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/basics/paradigm.html">13.3. 渲染的基本范式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/basics/summary.html">13.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../rendering/shading/index.html">14. 光照与着色</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/shading/pipeline.html">14.1. 实时渲染管线</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/shading/empirical-lighting.html">14.2. 经验光照模型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/shading/npr.html">14.3. 非真实感渲染</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/shading/summary.html">14.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../rendering/textures/index.html">15. 纹理映射</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/textures/filtering.html">15.1. 纹理过滤</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/textures/reflectance.html">15.2. 反射贴图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/textures/bump.html">15.3. 凹凸贴图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/textures/shadows.html">15.4. 阴影映射</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/textures/summary.html">15.5. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../rendering/global-illum/index.html">16. 全局光照</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/global-illum/equation.html">16.1. 渲染方程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/global-illum/physical-lighting.html">16.2. 基于物理的光照模型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/global-illum/approximations.html">16.3. 间接光照的近似算法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/global-illum/ray-tracing.html">16.4. 光线追踪算法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/global-illum/summary.html">16.5. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../rendering/acc-structs/index.html">17. 空间加速结构</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/acc-structs/bvh.html">17.1. 层次包围体</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/acc-structs/kd-trees.html">17.2. KD 树</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/acc-structs/grids.html">17.3. 均匀网格</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/acc-structs/summary.html">17.4. 本章小结</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IV. 动态生成</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../basics/index.html">18. 动态生成基础</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/subjective.html">18.1. 主观动态</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/physics.html">18.2. 物理动态</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/summary.html">18.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../kinematic-principles/index.html">19. 运动学原理</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../kinematic-principles/rotation-representation.html">19.1. 旋转的表示</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kinematic-principles/kinematics.html">19.2. 运动学</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kinematic-principles/summary.html">19.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../character/index.html">20. 角色动画</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../character/motion-capture.html">20.1. 动作捕捉</a></li>
<li class="toctree-l2"><a class="reference internal" href="../character/motion-synthesis.html">20.2. 动作合成</a></li>
<li class="toctree-l2"><a class="reference internal" href="../character/skinning.html">20.3. 骨骼蒙皮</a></li>
<li class="toctree-l2"><a class="reference internal" href="../character/summary.html">20.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">21. 弹性体模拟</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mass-spring.html">21.1. 弹簧质点系统</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">21.2. 有限元方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">21.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../rigid-bodies/index.html">22. 刚体模拟</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../rigid-bodies/rigid-body-dynamics.html">22.1. 刚体动力学</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rigid-bodies/contact-and-friction.html">22.2. 碰撞与摩擦</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rigid-bodies/articulated-rigid-body.html">22.3. 铰链刚体</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rigid-bodies/summary.html">22.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fluids/index.html">23. 流体模拟</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../fluids/fluid-physics.html">23.1. 流体的物理模型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fluids/sph-method.html">23.2. 光滑粒子流体</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fluids/eulerian-fluid.html">23.3. 欧拉网格流体</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fluids/summary.html">23.4. 本章小结</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">V. 可视化与交互</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../visualization/basics/index.html">24. 可视化基础</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/basics/overview.html">24.1. 可视化概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/basics/content.html">24.2. 可视化研究内容</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/basics/design.html">24.3. 可视化设计</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/basics/data.html">24.4. 数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/basics/interaction.html">24.5. 可视化中的交互</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/basics/summary.html">24.6. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../visualization/scientific/index.html">25. 科学可视化</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/scientific/dimensional.html">25.1. 标量场、矢量场、张量场数据的可视化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/scientific/spatial.html">25.2. 表面数据、体积数据的可视化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/scientific/summary.html">25.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../visualization/informational/index.html">26. 信息可视化</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/informational/plot.html">26.1. 基础绘图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/informational/types.html">26.2. 不同类型的信息可视化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/informational/summary.html">26.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../visualization/analytics/index.html">27. 可视分析学</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/analytics/overview.html">27.1. 可视分析概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/analytics/system.html">27.2. 可视分析系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/analytics/summary.html">27.3. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../interaction/basics/index.html">28. 人机交互基础</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/basics/overview.html">28.1. 总览：理解交互技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/basics/device.html">28.2. 经典交互技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/basics/assess.html">28.3. 交互技术的评估方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/basics/summary.html">28.4. 本章小结</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../interaction/spatial/index.html">29. 空间交互技术</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/spatial/input.html">29.1. 三维交互技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/spatial/xr-techniques.html">29.2. 虚拟现实与增强现实</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/spatial/summary.html">29.3. 本章小结</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="下载此页面">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/animation/elastomers/fem.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="下载源文件"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="列印成 PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全屏模式"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="亮色"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="暗色"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>有限元方法</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目录 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">21.2.1. 物理模型</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">21.2.1.1. 描述形变</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-energy">21.2.1.2. 描述能量</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-force">21.2.1.3. 描述力</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-energy-force">21.2.1.4. 能量与力的关系</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-models">21.2.1.5. 常见超弹性模型</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">21.2.1.5.1. 线性模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">21.2.1.5.2. 圣维南-基尔霍夫模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">21.2.1.5.3. 共旋转线性模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">21.2.1.5.4. 新胡克模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">21.2.1.5.5. 各种本构模型的比较</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-discretization">21.2.2. 空间离散化</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">21.2.2.1. 变形函数的选择</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">21.2.2.2. 形变梯度的计算</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">21.2.2.3. 能量与力的计算</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">21.2.3. 数值求解算法</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-explicit-euler">21.2.3.1. 显式时间积分</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">21.2.3.2. 隐式时间积分</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  
<style>
  .ss-layout-default-ABCD { grid-template-areas: 'A B C D'; }
  .ss-layout-default-A_B { grid-template-areas: 'A' 'B'; }
  .ss-layout-default-AC_BD { grid-template-areas: 'A C' 'B D'; }
@media (max-width: 576px) {
  .ss-layout-sm-AB_CD { grid-template-areas: 'A B' 'C D'; }
  .ss-layout-sm-A_B_C_D { grid-template-areas: 'A' 'B' 'C' 'D'; }
}
</style>
<section class="tex2jax_ignore mathjax_ignore" id="sec-animation-elastomers-fem">
<span id="id1"></span><h1><span class="section-number">21.2. </span>有限元方法<a class="headerlink" href="#sec-animation-elastomers-fem" title="Link to this heading">#</a></h1>
<figure class="align-default" id="fig-animation-elastomers-tetrahedron">
<a class="reference internal image-reference" href="../../_images/animation-elastomers-tetrahedron.png"><img alt="../../_images/animation-elastomers-tetrahedron.png" src="../../_images/animation-elastomers-tetrahedron.png" style="width: 25%;" />
</a>
<figcaption>
<p><span class="caption-number">图 21.7 </span><span class="caption-text">一个正四面体形状的弹性体被离散化成弹簧质点系统，其底面三个黑色顶点固定，顶部蓝色顶点受到向下的力 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 的作用。</span><a class="headerlink" href="#fig-animation-elastomers-tetrahedron" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>弹簧质点系统给出了一个对弹性物体十分简单的建模，在一定范围内的形变下能够较好地模拟出弹性的动态；然而对于一些较为极端的情形，它将会产生错误的结果。我们以一个体积很小的弹性正四面体为例，其底面固定，一较大的向下的外力 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 作用于四面体的顶部。如<a class="reference internal" href="#fig-animation-elastomers-tetrahedron"><span class="std std-numref">图 21.7</span></a> 所示，在弹簧质点系统下这个正四面体会自然地被空间离散化成四个处于顶点处、由弹簧两两连接的质点，每根弹簧的原长为正四面体的边长 <span class="math notranslate nohighlight">\(l\)</span>，劲度系数为 <span class="math notranslate nohighlight">\(k\)</span>；底面的三个质点（<a class="reference internal" href="#fig-animation-elastomers-tetrahedron"><span class="std std-numref">图 21.7</span></a> 中的黑色顶点）固定，顶部的质点（<a class="reference internal" href="#fig-animation-elastomers-tetrahedron"><span class="std std-numref">图 21.7</span></a> 中的蓝色顶点）受到力 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 的作用。这个场景的动态如<a class="reference internal" href="#fig-animation-elastomers-tetrahedron-dynamics"><span class="std std-numref">图 21.8</span></a> 所示：初始时四面体静止，顶部质点只受到 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 的作用开始向下运动；随后由于顶部质点所连接的三根弹簧被压缩，顶部质点还会受到三根弹簧的弹力，由于是正四面体，三个弹力的合力向上，这也符合弹性体总是倾向于恢复原状的性质；但是三根弹簧的合力大小存在上界，当 <span class="math notranslate nohighlight">\(\Vert\boldsymbol F\Vert&gt;3kl\)</span>（即 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 的大小比三根弹簧压缩至 <span class="math notranslate nohighlight">\(0\)</span> 长度的弹力总和还大）时，顶部质点的合力一直向下，从而会一直加速向下运动，即便整个四面体已经被完全压扁乃至反向；在四面体反向后更严重的问题发生了，此时弹簧的合力朝下，也就是说即便撤掉力 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span>，四面体也不会恢复至原状。</p>
<figure class="sphinx-subfigure align-default" id="fig-animation-elastomers-tetrahedron-dynamics" style="width: 100%">
<div class="sphinx-subfigure-grid ss-layout-default-ABCD ss-layout-sm-AB_CD" style="display: grid; gap: 8px; grid-gap: 8px;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<img alt="../../_images/animation-elastomers-tetrahedron_a.png" src="../../_images/animation-elastomers-tetrahedron_a.png" />
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<img alt="../../_images/animation-elastomers-tetrahedron_b.png" src="../../_images/animation-elastomers-tetrahedron_b.png" />
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: C;">
<img alt="../../_images/animation-elastomers-tetrahedron_c.png" src="../../_images/animation-elastomers-tetrahedron_c.png" />
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: D;">
<img alt="../../_images/animation-elastomers-tetrahedron_d.png" src="../../_images/animation-elastomers-tetrahedron_d.png" />
</div>
</div>
<figcaption>
<p><span class="caption-number">图 21.8 </span><span class="caption-text">正四面体弹簧质点系统的动态</span><a class="headerlink" href="#fig-animation-elastomers-tetrahedron-dynamics" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>这个例子告诉我们弹簧质点系统只能模拟一个弹性的“框架”，而在生活中常见的弹性体通常是具有一定体积的连续物体，所以不应当出现上述被完全压扁至 <span class="math notranslate nohighlight">\(0\)</span> 体积的情况；即便是在一些极端的数值条件下出现了体积翻转的情况，弹性力也应当趋向于恢复成体积翻转前的原本形状。</p>
<p>有限元方法就具备这样的性质，它将一个物体空间离散化成四面体网格，每个最小模拟单元不再是弹簧与质点，而是单个四面体；每个四面体无缝拼接在一起，形成一个占有一定体积的连续形状，从而能够更加贴近现实中弹性体的行为。但是这样的模型也会更加的复杂，我们需要了解更多的物理背景才能够正确地借助这个模型进行模拟。</p>
<section id="id2">
<h2><span class="section-number">21.2.1. </span>物理模型<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>在本章中，我们需要借助连续介质力学（continuum mechanics）中的一些概念来刻画弹性体的物理动态。在接触一个新的力学分支时，我们应当先了解它的语言，理解它描述各种力学概念的方式，随后才能够应用它完成我们想要的任务。对于弹性体来讲，我们先从其运动学开始，理解如何描述一个弹性体的形变；随后再进入到动力学，从弹性体的能量到它的内力；再将二者联系起来，从而理解力如何影响弹性体的运动。</p>
<section id="id3">
<h3><span class="section-number">21.2.1.1. </span>描述形变<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>在弹簧质点系统中，我们通过记录每个质点的位置来描述弹性体的当前形状；但对于一个连续介质，存在不可数个质点，因此我们也应当将形变的描述方式拓展成场，将未形变状态下每一个点的位置都映射成形变后的位置。具体来讲，我们首先将未形变的弹性体放置于一个空间坐标系当中，并记其所占据的空间区域为 <span class="math notranslate nohighlight">\(\Omega\)</span>，这个区域又称为参考构型（reference configuration）；我们记参考构型内的点为 <span class="math notranslate nohighlight">\(\boldsymbol X\)</span>，该点在形变后的位置为 <span class="math notranslate nohighlight">\(\boldsymbol x\)</span>，定义变形函数（deformation function）</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-deformation-function">
<span class="eqno">(21.17)<a class="headerlink" href="#equation-animation-elastomers-deformation-function" title="Link to this equation">#</a></span>\[\begin{split}
\boldsymbol\phi:\Omega&amp;\to\mathbb R^3\\
\boldsymbol X&amp;\mapsto\boldsymbol x
\end{split}\]</div>
<p>即为对弹性体形变的描述。</p>
<figure class="align-default" id="fig-animation-elastomers-deform-map">
<a class="reference internal image-reference" href="../../_images/animation-elastomers-deform_map.png"><img alt="../../_images/animation-elastomers-deform_map.png" src="../../_images/animation-elastomers-deform_map.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">图 21.9 </span><span class="caption-text">参考构型 <span class="math notranslate nohighlight">\(\Omega\)</span>、形变前位置 <span class="math notranslate nohighlight">\(\boldsymbol X\)</span>、形变后位置 <span class="math notranslate nohighlight">\(\boldsymbol x\)</span> 与变形函数 <span class="math notranslate nohighlight">\(\boldsymbol\phi\)</span> 的关系</span><a class="headerlink" href="#fig-animation-elastomers-deform-map" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>变形函数 <span class="math notranslate nohighlight">\(\boldsymbol\phi\)</span> 确实能够充分地表示出弹性体的形变，但作为一个<strong>全局</strong>的信息表示，它包含了过多的信息。我们马上就会看到，弹性体每一个点的能量与内力只由其<strong>局部</strong>的形变所决定。因此，在连续介质力学中会引入形变梯度（deformation gradient）的概念，形变梯度一般记为 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span>，其定义为变形函数 <span class="math notranslate nohighlight">\(\boldsymbol\phi\)</span> 关于形变前位置 <span class="math notranslate nohighlight">\(\boldsymbol X\)</span> 的雅可比矩阵：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-deformation-gradient">
<span class="eqno">(21.18)<a class="headerlink" href="#equation-animation-elastomers-deformation-gradient" title="Link to this equation">#</a></span>\[\begin{split}
\boldsymbol F\mathrel{\mathop:}=\frac{\partial(\phi_x,\phi_y,\phi_z)}{\partial(X,Y,Z)}=\begin{bmatrix}\frac{\partial\phi_x}{\partial X}&amp;\frac{\partial\phi_x}{\partial Y}&amp;\frac{\partial\phi_x}{\partial Z}\\\frac{\partial\phi_y}{\partial X}&amp;\frac{\partial\phi_y}{\partial Y}&amp;\frac{\partial\phi_z}{\partial Z}\\\frac{\partial\phi_z}{\partial X}&amp;\frac{\partial\phi_z}{\partial Y}&amp;\frac{\partial\phi_z}{\partial Z}\end{bmatrix}，
\end{split}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol\phi(\boldsymbol X)=\begin{pmatrix}\phi_x&amp;\phi_y&amp;\phi_z\end{pmatrix}^\top\)</span>，<span class="math notranslate nohighlight">\(\boldsymbol X=\begin{pmatrix}X&amp;Y&amp;Z\end{pmatrix}^\top\)</span>。我们知道导数可以很好地反映原函数的局部特征，所以在连续介质力学中形变梯度是最常用也最直观的刻画弹性体形变的量之一，变形函数反而没有那么重要。</p>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<ol class="arabic simple">
<li><p>由式 <a class="reference internal" href="#equation-animation-elastomers-deformation-gradient">(21.18)</a> 可见，形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 是一个关于形变前坐标 <span class="math notranslate nohighlight">\(\boldsymbol X\)</span> 的矩阵函数。</p></li>
<li><p>在本章的后续内容中，我们将继续使用不加粗的 <span class="math notranslate nohighlight">\(x,y,z\)</span> 和 <span class="math notranslate nohighlight">\(X,Y,Z\)</span> 分别表示形变后和参考构型下的坐标分量。</p></li>
</ol>
</div>
</section>
<section id="sec-animation-elastomers-fem-energy">
<span id="id4"></span><h3><span class="section-number">21.2.1.2. </span>描述能量<a class="headerlink" href="#sec-animation-elastomers-fem-energy" title="Link to this heading">#</a></h3>
<p>弹性体的形变会累积弹性势能，在连续介质力学中又称为应变能（strain energy）。由于总能量完全由弹性体的形变决定，我们可以将应变能表示成变形函数的泛函 <span class="math notranslate nohighlight">\(E[\boldsymbol\phi]\)</span>。值得注意的是，在这种表示中，应变能的值仅与弹性体的<strong>最终</strong>形变有关，和弹性体的变形<strong>路径</strong>（或<strong>历史时刻</strong>的形变）无关，也即弹性力是保守力（conservative force）。这个性质是超弹性（hyperelastic）材料的特性，在本章中我们只会讨论这一种材料的模拟。</p>
<p>一般来讲，弹性体不同位置的材料会有不同的形变，因此为了准确描述每一处材料的动态，我们应当把能量定义在局部范围上。与变形函数的定义类似，我们定义一个以参考构型下的位置为自变量的能量密度函数 <span class="math notranslate nohighlight">\(\Psi[\boldsymbol\phi;\boldsymbol X]\)</span>，其含义为单位体积未形变材料所蕴含的应变能。将能量密度在参考构型上积分即可得到应变能：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-energy">
<span class="eqno">(21.19)<a class="headerlink" href="#equation-animation-elastomers-energy" title="Link to this equation">#</a></span>\[
E[\boldsymbol\phi]=\int_\Omega\Psi[\boldsymbol\phi;\boldsymbol X]\mathrm d\boldsymbol X。
\]</div>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>我们现在没有给出能量密度 <span class="math notranslate nohighlight">\(\Psi\)</span> 的具体形式，只描述了能量由什么决定。事实上，<span class="math notranslate nohighlight">\(\Psi\)</span> 的形式有多种，对应于不同性质的弹性材料，<a class="reference internal" href="#sec-animation-elastomers-fem-models"><span class="std std-numref">§21.2.1.5</span></a> 将会给出一些常见的形式。</p>
</div>
<p>下面我们考虑参考构型下一个特定位置 <span class="math notranslate nohighlight">\(\boldsymbol X_0\)</span> 的能量密度 <span class="math notranslate nohighlight">\(\Psi[\boldsymbol\phi;\boldsymbol X_0]\)</span>。由于能量密度是一个局部的物理量，它应当只与 <span class="math notranslate nohighlight">\(\boldsymbol X_0\)</span> 附近一个无穷小的邻域形变后的状态相关，在 <span class="math notranslate nohighlight">\(\boldsymbol X_0\)</span> 处 <span class="math notranslate nohighlight">\(\boldsymbol\phi(\boldsymbol X)\)</span> 进行一阶泰勒展开</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-phi-taylor-expansion">
<span class="eqno">(21.20)<a class="headerlink" href="#equation-animation-elastomers-phi-taylor-expansion" title="Link to this equation">#</a></span>\[\begin{split}
\boldsymbol\phi(\boldsymbol X)&amp;\approx\boldsymbol\phi(\boldsymbol X_0)+\frac{\partial\boldsymbol\phi}{\partial\boldsymbol X}(\boldsymbol X_0)(\boldsymbol X-\boldsymbol X_0)\\
&amp;=\boldsymbol x_0+\boldsymbol F(\boldsymbol X_0)(\boldsymbol X-\boldsymbol X_0)\\
&amp;=\boldsymbol F(\boldsymbol X_0)\boldsymbol X+\boldsymbol x_0-\boldsymbol F(\boldsymbol X_0)\boldsymbol X_0，
\end{split}\]</div>
<p>其中，<span class="math notranslate nohighlight">\(\boldsymbol x_0=\boldsymbol\phi(\boldsymbol X_0)\)</span> 为其大写字母符号对应的形变后位置，本章中将继续遵循这个命名习惯。令 <span class="math notranslate nohighlight">\(\boldsymbol F_0=\boldsymbol F(\boldsymbol X_0)\)</span>（这个命名习惯也会在本章中继续使用），<span class="math notranslate nohighlight">\(\boldsymbol t=\boldsymbol x_0-\boldsymbol F_0\boldsymbol X_0\)</span>，则式 <a class="reference internal" href="#equation-animation-elastomers-phi-taylor-expansion">(21.20)</a> 最终可化为 <span class="math notranslate nohighlight">\(\boldsymbol\phi(\boldsymbol X)\approx\boldsymbol F_0\boldsymbol X+\boldsymbol t\)</span>。这告诉我们参考构型下 <span class="math notranslate nohighlight">\(\boldsymbol X_0\)</span> 周围很小一块区域的形变可以完全由 <span class="math notranslate nohighlight">\(\boldsymbol F_0\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol t\)</span> 刻画，而 <span class="math notranslate nohighlight">\(\boldsymbol t\)</span> 仅仅代表这个小区域整体的平移，不会带来任何变形，所以这个小区域的能量应当完全由 <span class="math notranslate nohighlight">\(\boldsymbol F_0\)</span> 决定，也即 <span class="math notranslate nohighlight">\(\Psi\)</span> 能够表示成只关于形变梯度的函数：<span class="math notranslate nohighlight">\(\Psi[\boldsymbol\phi;\boldsymbol X_0]=\hat\Psi(\boldsymbol F(\boldsymbol X_0))\)</span>。为了简便，我们在接下来将使用 <span class="math notranslate nohighlight">\(\Psi(\boldsymbol F)\)</span> 来表示能量密度函数。</p>
</section>
<section id="sec-animation-elastomers-fem-force">
<span id="id5"></span><h3><span class="section-number">21.2.1.3. </span>描述力<a class="headerlink" href="#sec-animation-elastomers-fem-force" title="Link to this heading">#</a></h3>
<p>弹性体积累了弹性势能就会产生弹性力，我们仍然可以借助<a class="reference internal" href="mass-spring.html#fig-animation-elastomers-simple-example"><span class="std std-numref">图 21.1</span></a> 中的例子来回顾一下势能与保守力之间的关系：当粒子处于位置 <span class="math notranslate nohighlight">\(\boldsymbol x=\begin{pmatrix}x&amp;y&amp;z\end{pmatrix}^\top\)</span> 时，其重力势能为 <span class="math notranslate nohighlight">\(E(\boldsymbol x)=m\boldsymbol{G\cdot x}=mgz\)</span>，其中 <span class="math notranslate nohighlight">\(\boldsymbol G=\begin{pmatrix}0&amp;0&amp;g\end{pmatrix}^\top\)</span> 为重力加速度（取 <span class="math notranslate nohighlight">\(z\)</span> 轴正方向为竖直向上），那么粒子所受重力即为</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol f_\mathrm{gravity}=-\frac{\partial E(\boldsymbol x)}{\partial\boldsymbol x}=\begin{pmatrix}0\\0\\-mg\end{pmatrix}。
\end{split}\]</div>
<p>由此可见，保守力等于能量的负梯度。在连续介质中，由于存在不可数无穷多个质点，我们同样需要类似能量密度一样定义一个力密度（force density）<span class="math notranslate nohighlight">\(\boldsymbol f(\boldsymbol X)\)</span>，代表单位体积未形变材料所受的力。对于标准构型内的任意有限区域 <span class="math notranslate nohighlight">\(A\subset\Omega\)</span>，其形变后所受力的总和为力密度在 <span class="math notranslate nohighlight">\(A\)</span> 上的积分：</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol f_\mathrm{aggregate}(A)=\int_A\boldsymbol f(\boldsymbol X)\mathrm d\boldsymbol X。
\]</div>
<p>然而，只定义这样一种力密度不足以描述一个弹性体的全部受力，我们还需要引入牵引力（traction）的概念来描述弹性体表面所受的力。牵引力 <span class="math notranslate nohighlight">\(\boldsymbol\tau:\partial\Omega\to\mathbb R^3\)</span> 是一个定义在标准构型表面的向量函数，含义是每单位面积未形变材料表面所受的力。对于标准构型边界上任意有限区域 <span class="math notranslate nohighlight">\(B\subset\partial\Omega\)</span>，其形变后所受的表面力为牵引力在 <span class="math notranslate nohighlight">\(B\)</span> 上的积分：</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol f_\mathrm{aggregate}(B)=\oint_S\boldsymbol\tau(\boldsymbol X)\mathrm dS。
\]</div>
<p>我们为什么要将弹性体的力密度与表面受力分开表示呢？读者不难注意到，牵引力的单位是牛顿每平方米，而力密度的单位是牛顿每立方米，也就是说牵引力带来的力是远比力密度带来的大。这也是弹性体常见的受力情况——表面的受力要远大于内部的受力，如果我们仅使用力密度来描述整个弹性体的受力的话，那么表面处的力密度将会变成无穷大，这样在计算上就没有意义了。因此，为了弥补定义上的缺陷，我们额外引入牵引力来描述弹性体表面所受的力，这样一来力密度和牵引力就都是有限函数了。</p>
<p>但仅到这里还不能解开读者所有的疑惑——为什么弹性体表面的受力和内部受力会有这么大差别呢？如<a class="reference internal" href="#fig-animation-elastomers-interior-surface"><span class="std std-numref">图 21.10</span></a> 所示，我们在弹性体的内部取一点 <span class="math notranslate nohighlight">\(P_1\)</span>，表面处取一点 <span class="math notranslate nohighlight">\(P_2\)</span>，然后考察两点附近小邻域的受力：它们都会受到来自周围材料的弹性力，而区别在于内部点 <span class="math notranslate nohighlight">\(P_1\)</span> 受到的力是来自四面八方的，几乎能够完全抵消；<span class="math notranslate nohighlight">\(P_2\)</span> 由于处在表面，有一侧没有材料，所以只会受到单侧的弹性力，形成一种“强烈”的不平衡状态。这就是为什么表面受到的力一般会远大于内部受到的力。</p>
<figure class="align-default" id="fig-animation-elastomers-interior-surface">
<a class="reference internal image-reference" href="../../_images/animation-elastomers-interior_surface.png"><img alt="../../_images/animation-elastomers-interior_surface.png" src="../../_images/animation-elastomers-interior_surface.png" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-number">图 21.10 </span><span class="caption-text">内部与表面处受力的区别</span><a class="headerlink" href="#fig-animation-elastomers-interior-surface" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="sec-animation-elastomers-fem-energy-force">
<span id="id6"></span><h3><span class="section-number">21.2.1.4. </span>能量与力的关系<a class="headerlink" href="#sec-animation-elastomers-fem-energy-force" title="Link to this heading">#</a></h3>
<p>在 <a class="reference internal" href="#sec-animation-elastomers-fem-force"><span class="std std-numref">§21.2.1.3</span></a> 的开头我们回顾了质点重力场中能量与力的关系，但是对本章讨论的弹性体而言情况会更加复杂一些，我们不能直接建立能量密度 <span class="math notranslate nohighlight">\(\Psi\)</span> 与力密度 <span class="math notranslate nohighlight">\(\boldsymbol f(\boldsymbol X)\)</span> 和牵引力 <span class="math notranslate nohighlight">\(\boldsymbol\tau(\boldsymbol X)\)</span> 之间的关系。幸运的是，这个关系可以通过引入一个中间变量建立起来，这个中间变量叫做第一类皮奥拉-基尔霍夫应力张量（first Piola-Kirchhoff stress tensor），一般记作 <span class="math notranslate nohighlight">\(\boldsymbol P\)</span>。接下来我们不加证明地给出 <span class="math notranslate nohighlight">\(\boldsymbol P\)</span> 的性质，对更深层原理感兴趣的同学可以参考 <span id="id7">[<a class="reference internal" href="summary.html#id5" title="Eftychios Sifakis and Jernej Barbic. Fem simulation of 3d deformable solids: a practitioner's guide to theory, discretization and model reduction. In Acm siggraph 2012 courses, pages 1–50. 2012.">SB12</a>]</span>。</p>
<p>首先，我们可以通过能量密度 <span class="math notranslate nohighlight">\(\Psi\)</span> 计算 <span class="math notranslate nohighlight">\(\boldsymbol P\)</span>：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-calc-stress">
<span class="eqno">(21.21)<a class="headerlink" href="#equation-animation-elastomers-calc-stress" title="Link to this equation">#</a></span>\[
\boldsymbol P=\frac{\partial\Psi(\boldsymbol F)}{\partial\boldsymbol F}。
\]</div>
<p>边界上的牵引力 <span class="math notranslate nohighlight">\(\boldsymbol\tau\)</span> 与 <span class="math notranslate nohighlight">\(\boldsymbol P\)</span> 具有如下的关系：</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol\tau(\boldsymbol X)=-\boldsymbol P\cdot\boldsymbol N,\quad\forall\boldsymbol X\in\partial\Omega，
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol N\)</span> 为 <span class="math notranslate nohighlight">\(\boldsymbol X\)</span> 处<strong>形变前</strong>物体的表面法向，这里的点乘就是矩阵乘法。</p>
<p>另外，力密度 <span class="math notranslate nohighlight">\(\boldsymbol f\)</span> 与 <span class="math notranslate nohighlight">\(\boldsymbol P\)</span> 具有如下的关系：</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol f(\boldsymbol X)=\mathrm{div}\boldsymbol P(\boldsymbol X)，
\]</div>
<p>写成分量形式就是（省略自变量 <span class="math notranslate nohighlight">\(\boldsymbol X\)</span>）</p>
<div class="math notranslate nohighlight">
\[
f_i=\sum_{j=1}^3\frac{\partial P_{ij}}{\partial X_j}。
\]</div>
</section>
<section id="sec-animation-elastomers-fem-models">
<span id="id8"></span><h3><span class="section-number">21.2.1.5. </span>常见超弹性模型<a class="headerlink" href="#sec-animation-elastomers-fem-models" title="Link to this heading">#</a></h3>
<p>前面的讨论中我们给出了弹性体的形变、能量和应力之间的关系，但是我们还没办法计算一个弹性体的具体受力情况。事实上，我们只需要知道能量密度 <span class="math notranslate nohighlight">\(\Psi(\boldsymbol F)\)</span> 的具体表达式即可进行计算，每一种能量密度的具体形式对应于一种本构模型（constitutive model），它充分描述了弹性体的全部力学性质。在本节，我们将给出一些常见超弹性模型的能量密度的具体形式，并且为了避免每次都计算一遍矩阵求导，我们会同时给出 <span class="math notranslate nohighlight">\(\boldsymbol P\)</span> 的表达式。</p>
<section id="id9">
<h4><span class="section-number">21.2.1.5.1. </span>线性模型<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>正常来讲，能量密度的具体形式应当是 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 的表达式。但是我们往往难以直接使用 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 的元素直接描述出形变与力的关系，而是需要借助一些中间变量。现在我们介绍其中一种中间变量——格林应变张量（Green strain tensor），定义如下：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-green-strain-tensor">
<span class="eqno">(21.22)<a class="headerlink" href="#equation-animation-elastomers-fem-green-strain-tensor" title="Link to this equation">#</a></span>\[
\boldsymbol E=\frac 12\left(\boldsymbol F^\top\boldsymbol F-\mathbf I\right)。
\]</div>
<p>格林应变张量具有一些良好的性质，使其能够较好地反映出弹性形变的程度。当弹性体只经历了刚性运动时，其变形函数为 <span class="math notranslate nohighlight">\(\boldsymbol\phi(\boldsymbol X)=\boldsymbol{RX}+\boldsymbol t\)</span>，其中 <span class="math notranslate nohighlight">\(\boldsymbol R\)</span> 为旋转矩阵，<span class="math notranslate nohighlight">\(\boldsymbol t\)</span> 为平移向量，则 <span class="math notranslate nohighlight">\(\boldsymbol F=\boldsymbol R\)</span>，此时格林应变张量为 <span class="math notranslate nohighlight">\(\boldsymbol E=\frac 12\left(\boldsymbol R^\top\boldsymbol R-\mathbf I\right)=\mathbf 0\)</span>——这表明格林应变张量不会受刚性运动的影响，又称为刚性运动下的不变量（invariant）。对于更一般的形变，我们可以将形变梯度进行极分解 <span class="math notranslate nohighlight">\(\boldsymbol F=\boldsymbol{RS}\)</span>，表示成旋转矩阵 <span class="math notranslate nohighlight">\(\boldsymbol R\)</span> 和对称矩阵 <span class="math notranslate nohighlight">\(\boldsymbol S\)</span> 乘积的形式，那么格林应变张量可化为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-green-strain-tensor-in-terms-of-s">
<span class="eqno">(21.23)<a class="headerlink" href="#equation-animation-elastomers-fem-green-strain-tensor-in-terms-of-s" title="Link to this equation">#</a></span>\[
\boldsymbol E=\frac 12\left(\boldsymbol S^\top\boldsymbol R^\top\boldsymbol{RS}-\mathbf I\right)=\frac 12\left(\boldsymbol S^2-\mathbf I\right)。
\]</div>
<p>这表明格林应变张量只和形变梯度的对称因子 <span class="math notranslate nohighlight">\(\boldsymbol S\)</span> 有关，而 <span class="math notranslate nohighlight">\(\boldsymbol S\)</span> 中包含了拉伸、剪切这些真正导致弹力的信息。</p>
<p>但是，格林应变张量也存在缺点——关于 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 非线性，相比线性能量形式的本构模型而言，这会加大模拟的计算量。因此，为了解决这个问题，我们引入一个 <span class="math notranslate nohighlight">\(\boldsymbol E\)</span> 的线性近似作为小应变张量（small strain tensor），其定义如下：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-small-strain-tensor">
<span class="eqno">(21.24)<a class="headerlink" href="#equation-animation-elastomers-fem-small-strain-tensor" title="Link to this equation">#</a></span>\[
\boldsymbol\epsilon=\frac 12\left(\boldsymbol F+\boldsymbol F^\top\right)-\mathbf I。
\]</div>
<p>关于 <span class="math notranslate nohighlight">\(\boldsymbol\epsilon\)</span> 是 <span class="math notranslate nohighlight">\(\boldsymbol E\)</span> 的线性近似的证明可以参考 <span id="id10">[<a class="reference internal" href="summary.html#id5" title="Eftychios Sifakis and Jernej Barbic. Fem simulation of 3d deformable solids: a practitioner's guide to theory, discretization and model reduction. In Acm siggraph 2012 courses, pages 1–50. 2012.">SB12</a>]</span>。借助小应变张量，我们立即可以定义出线性模型的能量密度：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-linear-elasticity-energy">
<span class="eqno">(21.25)<a class="headerlink" href="#equation-animation-elastomers-fem-linear-elasticity-energy" title="Link to this equation">#</a></span>\[
\Psi(\boldsymbol F)=\mu\mathrm{tr}\left(\boldsymbol\epsilon^2\right)+\frac\lambda 2\mathrm{tr}^2(\boldsymbol\epsilon)，
\]</div>
<p>其中，<span class="math notranslate nohighlight">\(\mu,\lambda\)</span> 是拉美系数（Lamé coefficients），它们可以通过杨氏模量（Young’s modulus）<span class="math notranslate nohighlight">\(k\)</span> 和泊松比（Poisson’s ratio）<span class="math notranslate nohighlight">\(\nu\)</span> 计算得到：</p>
<div class="math notranslate nohighlight">
\[
\begin{array}
&amp;\mu=\frac k{2(1+\nu)}，&amp;\lambda=\frac{k\nu}{(1+\nu)(1-2\nu)}，
\end{array}
\]</div>
<p>其中杨氏模量反应了材料对拉伸的抵抗能力，泊松比反应了材料的不可压性。线性模型的第一类皮奥拉-基尔霍夫应力张量为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-linear-elasticity-stress">
<span class="eqno">(21.26)<a class="headerlink" href="#equation-animation-elastomers-fem-linear-elasticity-stress" title="Link to this equation">#</a></span>\[
\boldsymbol P(\boldsymbol F)=2\mu\boldsymbol\epsilon+\lambda\mathrm{tr}(\boldsymbol\epsilon)\mathbf I。
\]</div>
<p>在线性模型中，虽然应力能够表示成形变梯度的线性函数从而能够快速地模拟，但由于小应变张量 <span class="math notranslate nohighlight">\(\boldsymbol\epsilon\)</span> 对格林应变张量 <span class="math notranslate nohighlight">\(\boldsymbol E\)</span> 在无形变（<span class="math notranslate nohighlight">\(\boldsymbol F=\mathbf I\)</span>）处进行了线性近似，所以只在材料形变很小的情况下才具有较好的性质。当材料形变过大时，<span class="math notranslate nohighlight">\(\boldsymbol\epsilon\)</span> 会与 <span class="math notranslate nohighlight">\(\boldsymbol E\)</span> 相差甚远，从而不再具有 <span class="math notranslate nohighlight">\(\boldsymbol E\)</span> 的忽略刚性运动等性质，模拟会产生错误的结果。</p>
</section>
<section id="id11">
<h4><span class="section-number">21.2.1.5.2. </span>圣维南-基尔霍夫模型<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<p>圣维南-基尔霍夫模型（St. Venant-Kirchhoff model）的能量形式就是将式 <a class="reference internal" href="#equation-animation-elastomers-fem-linear-elasticity-energy">(21.25)</a> 中的小应变张量替换成格林应变张量：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-stvk-energy">
<span class="eqno">(21.27)<a class="headerlink" href="#equation-animation-elastomers-fem-stvk-energy" title="Link to this equation">#</a></span>\[
\Psi(\boldsymbol F)=\mu\mathrm{tr}\left(\boldsymbol E^2\right)+\frac\lambda 2\mathrm{tr}^2(\boldsymbol E)，
\]</div>
<p>从而此模型具有格林应变张量的全部良好性质，但它不再是一个线性的本构模型。此模型的第一类皮奥拉-基尔霍夫应力张量为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-stvk-stress">
<span class="eqno">(21.28)<a class="headerlink" href="#equation-animation-elastomers-fem-stvk-stress" title="Link to this equation">#</a></span>\[
\boldsymbol P(\boldsymbol F)=\boldsymbol F[2\mu\boldsymbol E+\lambda\mathrm{tr}(\boldsymbol E)\mathbf I]。
\]</div>
<p>圣维南-基尔霍夫模型的一个典型问题在于无法抵抗过强的压缩。当一个该模型的材料从自然状态被压缩时，在刚开始它会产生抗拒压缩、恢复原体积的弹力；但随着压缩的力度逐渐增大、材料的体积逐渐减小，会出现弹力的最大值，此后弹力将逐渐减小；直至整个材料被压缩成一个质点，此时 <span class="math notranslate nohighlight">\(\boldsymbol F=\mathbf 0\)</span>，代入式 <a class="reference internal" href="#equation-animation-elastomers-fem-stvk-stress">(21.28)</a> 得到 <span class="math notranslate nohighlight">\(\boldsymbol P=\mathbf 0\)</span>，所以产生的力密度和牵引力均为 <span class="math notranslate nohighlight">\(\mathbf 0\)</span>；如果力的方向保持不变导致弹性体翻转，则产生出的弹力会试图恢复成翻转的参考构型，类似本章开头提到的弹簧质点系统产生的效果。这样的性质会导致模拟出的弹性体在强力的压缩作用下很容易产生打结、翻转等非物理的现象。</p>
</section>
<section id="id12">
<h4><span class="section-number">21.2.1.5.3. </span>共旋转线性模型<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<p>线性模型只能处理微小形变，圣维南-基尔霍夫模型又引入了过多的非线性项从而导致非物理的零应力现象，共旋转线性模型（corotated linear elasticity）的提出就是为了结合二者的设计、避免二者的问题，此模型尽可能地使用形变梯度的线性项去刻画应力，同时采用最少的非线性项来保证刚性运动下的不变性。此模型的能量形式为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-corotated-energy">
<span class="eqno">(21.29)<a class="headerlink" href="#equation-animation-elastomers-fem-corotated-energy" title="Link to this equation">#</a></span>\[
\Psi(\boldsymbol F)=\mu\Vert\boldsymbol S-\mathbf I\Vert_\mathrm F^2+\frac\lambda 2\mathrm{tr}^2(\boldsymbol S-\mathbf I)，
\]</div>
<p>其中形变梯度的极分解为 <span class="math notranslate nohighlight">\(\boldsymbol F=\boldsymbol S-\mathbf I\)</span>，所以这个模型的能量形式可以完全过滤掉材料的刚体运动，同时相比于式 <a class="reference internal" href="#equation-animation-elastomers-fem-stvk-energy">(21.27)</a>，式 <a class="reference internal" href="#equation-animation-elastomers-fem-corotated-energy">(21.29)</a> 中的能量模型关于 <span class="math notranslate nohighlight">\(\boldsymbol S\)</span> 的次数更低（前者为 <span class="math notranslate nohighlight">\(4\)</span> 次，后者为 <span class="math notranslate nohighlight">\(2\)</span> 次）。此模型的第一类皮奥拉-基尔霍夫应力张量为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-corotated-stress">
<span class="eqno">(21.30)<a class="headerlink" href="#equation-animation-elastomers-fem-corotated-stress" title="Link to this equation">#</a></span>\[
\boldsymbol P(\boldsymbol F)=2\mu(\boldsymbol F-\boldsymbol R)+\lambda\mathrm{tr}\left(\boldsymbol R^\top\boldsymbol F-\mathbf I\right)\boldsymbol R。
\]</div>
<p>共旋转线性模型试图找到一个最贴近形变后位置的旋转，并在这个旋转下模仿线性模型的行为，其模拟的计算量介于线性模型与圣维南-基尔霍夫模型之间，并且不会有非物理的零应力现象。</p>
</section>
<section id="id13">
<h4><span class="section-number">21.2.1.5.4. </span>新胡克模型<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<p>我们已经知道，圣维南-基尔霍夫模型和共旋转线性模型的能量和力在刚体运动下都不会发生变化，这种性质叫做旋转不变性（rotational invariance）。关于这个名称，由于能量密度的形式 <span class="math notranslate nohighlight">\(\Psi(\boldsymbol F)\)</span> 已经表明了平移下的不变性（形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 不受材料平移的影响），所以我们只会关注刚体运动中的旋转变换。下面我们给出旋转不变性的数学定义：</p>
<div class="proof definition admonition" id="def-animation-elastomers-fem-rotational_invariance">
<p class="admonition-title"><span class="caption-number">Definition 21.1 </span></p>
<section class="definition-content" id="proof-content">
<p>我们称一个超弹性本构模型是旋转不变的（或具有旋转不变性），当且仅当对于任意旋转矩阵 <span class="math notranslate nohighlight">\(\boldsymbol R\)</span> 和任意形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span>，其能量密度函数满足</p>
<div class="math notranslate nohighlight">
\[
\Psi(\boldsymbol{RF})=\Psi(\boldsymbol F)。
\]</div>
</section>
</div><p>一个本构模型具有旋转不变性，等价于其能量形式能够表示成形变梯度对称因子的函数，即对于任意形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F=\boldsymbol{RS}\)</span>，有 <span class="math notranslate nohighlight">\(\Psi(\boldsymbol F)=\Psi(\boldsymbol{RS})=\Psi(\boldsymbol S)\)</span>。显然，圣维南-基尔霍夫模型和共旋转线性模型的能量形式都能够表示成 <span class="math notranslate nohighlight">\(\boldsymbol S\)</span> 的函数。</p>
<p>另外一个形似但不同的概念叫做各向同性（isotropy），它表明一个超弹性材料对任意方向形变的抵抗是同样强的。这个概念只有在研究材料的局部性质时才有意义，因为如果从宏观角度考虑，任意一种材料组成的物体都可以通过巧妙地设计它的形状来使得它在总体上对某个方向的形变与其他方向不同。我们考虑一个体积无限小的球形弹性体，首先将其关于一个过球心的轴进行旋转，然后再对它施加一个特定的形变，各向同性的材料意味着无论第一步的旋转变换如何，最终得到的能量都是相等的。下面我们给出各向同性的数学定义：</p>
<div class="proof definition admonition" id="def-animation-elastomers-fem-isotropy">
<p class="admonition-title"><span class="caption-number">Definition 21.2 </span></p>
<section class="definition-content" id="proof-content">
<p>我们称一个超弹性本构模型是各向同性的，当且仅当对于任意旋转矩阵 <span class="math notranslate nohighlight">\(\boldsymbol R\)</span> 和任意形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span>，其能量密度函数满足</p>
<div class="math notranslate nohighlight">
\[
\Psi(\boldsymbol{FR})=\Psi(\boldsymbol F)。
\]</div>
</section>
</div><figure class="sphinx-subfigure align-default" id="fig-animation-elastomers-rotational-invariance-isotropy">
<div class="sphinx-subfigure-grid ss-layout-default-A_B" style="display: grid; gap: 8px; grid-gap: 8px;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<img alt="旋转不变性" src="../../_images/animation-elastomers-rotational_invariance.png" />
<span class="caption">旋转不变性</span>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<img alt="各向同性" src="../../_images/animation-elastomers-isotropy.png" />
<span class="caption">各向同性</span>
</div>
</div>
<figcaption>
<p><span class="caption-number">图 21.11 </span><span class="caption-text">旋转不变性与各向同性的区别。考虑一个微小的球体超弹性材料，球心处于原点，设 <span class="math notranslate nohighlight">\(\boldsymbol F=\begin{bmatrix}\frac 12&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{bmatrix}\)</span> 为将材料在 <span class="math notranslate nohighlight">\(x\)</span> 轴方向压缩的形变，<span class="math notranslate nohighlight">\(\boldsymbol R=\begin{bmatrix}0&amp;-1&amp;0\\1&amp;0&amp;0\\0&amp;0&amp;1\end{bmatrix}\)</span> 为将材料绕 <span class="math notranslate nohighlight">\(z\)</span> 轴旋转 <span class="math notranslate nohighlight">\(\frac\pi 2\)</span> 的变换。在旋转不变性的定义中，等式左侧的能量密度是在先进行 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 变换、后进行 <span class="math notranslate nohighlight">\(\boldsymbol R\)</span> 变换的形变上度量的，它等于只进行 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 变换带来的能量密度，这表明后续进行的旋转变换不会改变能量密度。在各向同性的定义中，等式左侧的能量密度是在先进行 <span class="math notranslate nohighlight">\(\boldsymbol R\)</span> 变换、后进行 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 变换的形变上度量的，原本沿 <span class="math notranslate nohighlight">\(y\)</span> 轴分布的材料在第一步旋转之后变成了沿 <span class="math notranslate nohighlight">\(x\)</span> 轴分布，第二步的 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 在 <span class="math notranslate nohighlight">\(x\)</span> 轴方向压缩了原先沿 <span class="math notranslate nohighlight">\(y\)</span> 轴分布的材料，而这样带来的能量密度与只进行 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 变换的能量密度表明材料沿 <span class="math notranslate nohighlight">\(x\)</span> 轴的抵抗和沿 <span class="math notranslate nohighlight">\(y\)</span> 轴的抵抗相同。</span><a class="headerlink" href="#fig-animation-elastomers-rotational-invariance-isotropy" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>可以看到 <a class="reference internal" href="#def-animation-elastomers-fem-rotational_invariance">Definition 21.1</a> 和 <a class="reference internal" href="#def-animation-elastomers-fem-isotropy">Definition 21.2</a> 的区别仅仅在于旋转矩阵与形变梯度乘积的次序，但这个细微差别带来的含义是迥然不同的——前者指的是对材料进行旋转不影响能量，后者指的是对形变梯度的方向进行旋转不影响能量，如<a class="reference internal" href="#fig-animation-elastomers-rotational-invariance-isotropy"><span class="std std-numref">图 21.11</span></a> 所示。</p>
<p>在我们身边，各向同性与各向异性的材料随处可见，如<a class="reference internal" href="#fig-animation-elastomers-isotropic-anisotropic-material"><span class="std std-numref">图 21.12</span></a> 所示。金属、橡胶等材料对各个方向的抵抗能力均相同，是典型的各向同性材料。我们每个人身上都有一种很典型的各向异性材料——肌肉，肌肉由多束平行的肌纤维组成，它对平行于肌纤维的形变与垂直方向的形变有着显著不同的响应。其余各向异性的材料还包括木材、碳纤维复合材料等，各向异性的材料一般都在微观结构上具有一定的方向性。</p>
<figure class="sphinx-subfigure align-default" id="fig-animation-elastomers-isotropic-anisotropic-material" style="width: 80%">
<div class="sphinx-subfigure-grid ss-layout-default-AC_BD ss-layout-sm-A_B_C_D" style="display: grid; gap: 8px; grid-gap: 8px;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<img alt="金属——各向同性" src="../../_images/animation-elastomers-isotropic_metal.jpg" />
<span class="caption">金属——各向同性</span>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<img alt="橡胶——各向同性" src="../../_images/animation-elastomers-isotropic_rubber.jpg" />
<span class="caption">橡胶——各向同性</span>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: C;">
<img alt="肌肉——各向异性" src="../../_images/animation-elastomers-anisotropic_muscle.png" />
<span class="caption">肌肉——各向异性</span>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: D;">
<img alt="木材——各向异性" src="../../_images/animation-elastomers-anisotropic_wood.jpg" />
<span class="caption">木材——各向异性</span>
</div>
</div>
<figcaption>
<p><span class="caption-number">图 21.12 </span><span class="caption-text">一些常见的各向同性与各向异性材料 <a class="footnote-reference brackets" href="#fig-animation-elastomers-isotropic-anisotropic-material-ref" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></span><a class="headerlink" href="#fig-animation-elastomers-isotropic-anisotropic-material" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>对于同时满足旋转不变性且各向同性的材料而言，对于任意两个旋转矩阵 <span class="math notranslate nohighlight">\(\boldsymbol P,\boldsymbol Q\)</span> 以及任意的形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span>，都有 <span class="math notranslate nohighlight">\(\Psi(\boldsymbol{PFQ})=\Psi(\boldsymbol F)\)</span>。那么如果我们对形变梯度进行奇异值分解 <span class="math notranslate nohighlight">\(\boldsymbol F=\boldsymbol{U\Sigma}\boldsymbol V^\top\)</span>，就可以立刻得到 <span class="math notranslate nohighlight">\(\Psi(\boldsymbol F)=\Psi(\boldsymbol\Sigma)\)</span>，也就是说能量密度的形式可以表示成形变梯度所有奇异值的函数。虽然任何一个旋转不变且各向同性的能量形式都能够直接用奇异值表示出来，但是在实践中	进行奇异值分解的计算量较大，所以我们会引入一些各向同性不变量（isotropic invariant），这些不变量只和奇异值相关，但无须奇异值分解就能计算出来；用这些不变量定义能量形式，就能够得到一个旋转不变且各向同性的本构模型，同时减少其模拟的计算量。这些不变量分别如下：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-isotropic-invariants">
<span class="eqno">(21.31)<a class="headerlink" href="#equation-animation-elastomers-fem-isotropic-invariants" title="Link to this equation">#</a></span>\[\begin{split}
&amp;I_1(\boldsymbol F)=\mathrm{tr}\left(\boldsymbol\Sigma^2\right)=\mathrm{tr}\left(\boldsymbol F^\top\boldsymbol F\right)，\\
&amp;I_2(\boldsymbol F)=\mathrm{tr}\left(\boldsymbol\Sigma^4\right)=\mathrm{tr}\left[\left(\boldsymbol F^\top\boldsymbol F\right)^2\right]，\\
&amp;I_3(\boldsymbol F)=\det\left(\boldsymbol\Sigma^2\right)=(\det\boldsymbol F)^2。
\end{split}\]</div>
<p>它们的导数分别是</p>
<div class="math notranslate nohighlight">
\[
\begin{array}
&amp;\frac{\partial I_1}{\partial\boldsymbol F}=2\boldsymbol F，&amp;\frac{\partial I_2}{\partial\boldsymbol F}=4\boldsymbol F\boldsymbol F^\top\boldsymbol F，&amp;\frac{\partial I_3}{\partial\boldsymbol F}=2I_3\boldsymbol F^{-\top}。
\end{array}
\]</div>
<p>因此，对于用这些不变量表示的能量形式 <span class="math notranslate nohighlight">\(\Psi(I_1,I_2,I_3)\)</span>，其第一类皮奥拉-基尔霍夫应力张量为</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol P(\boldsymbol F)=\frac{\partial\Psi}{\partial I_1}\cdot 2\boldsymbol F+\frac{\partial\Psi}{\partial I_2}\cdot 4\boldsymbol F\boldsymbol F^\top\boldsymbol F+\frac{\partial\Psi}{\partial I_3}\cdot 2I_3\boldsymbol F^{-\top}。
\]</div>
<p>新胡克模型（Neohookean elasticity）就是一个使用各向同性不变量定义能量形式的本构模型，其能量密度为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-neohookean-energy">
<span class="eqno">(21.32)<a class="headerlink" href="#equation-animation-elastomers-fem-neohookean-energy" title="Link to this equation">#</a></span>\[
\Psi(I_1,I_3)=\frac\mu 2[I_1-\log(I_3)-3]+\frac\lambda 8\log^2(I_3)，
\]</div>
<p>其第一类皮奥拉-基尔霍夫应力张量为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-fem-neohookean-stress">
<span class="eqno">(21.33)<a class="headerlink" href="#equation-animation-elastomers-fem-neohookean-stress" title="Link to this equation">#</a></span>\[
\boldsymbol P(\boldsymbol F)=\mu\boldsymbol F-\mu\boldsymbol F^{-\top}+\frac{\lambda\log(I_3)}2\boldsymbol F^{-\top}。
\]</div>
<p>从 <span class="math notranslate nohighlight">\(I_3\)</span> 的表达式可以看出，它反映了形变后材料相对形变前的体积大小。当体积被压缩至 <span class="math notranslate nohighlight">\(0\)</span> 时，<span class="math notranslate nohighlight">\(I_3\)</span> 会趋于 <span class="math notranslate nohighlight">\(0\)</span>，则式 <a class="reference internal" href="#equation-animation-elastomers-fem-neohookean-energy">(21.32)</a> 中的 <span class="math notranslate nohighlight">\(\log^2(I_3)\)</span> 项会占主导地位，让能量密度趋于正无穷；这样快速增长的能量会让材料对强烈的压缩产生巨大的抵抗，与圣维南-基尔霍夫模型形成了对比。利用这个性质，在模拟高度不可压的弹性体时，第二拉美系数 <span class="math notranslate nohighlight">\(\lambda\)</span> 会非常大，从而式 <a class="reference internal" href="#equation-animation-elastomers-fem-neohookean-energy">(21.32)</a> 中的 <span class="math notranslate nohighlight">\(\log^2(I_3)\)</span> 项的权重变大，惩罚形变后的体积变化。与此同时，这个性质也会是此模型的一个缺点，在模拟当中不可避免地会出现一些因数值爆炸或边缘情况导致的体积变零甚至反向的情况（即 <span class="math notranslate nohighlight">\(\det\boldsymbol F\le 0\)</span> 的情况），此时能量形式将不会有定义，所以在实际处理时会将当前形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span> 替换为一个最接近的、行列式为一个很小的正值 <span class="math notranslate nohighlight">\(\varepsilon\)</span> 的形变梯度。</p>
</section>
<section id="id15">
<h4><span class="section-number">21.2.1.5.5. </span>各种本构模型的比较<a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<p>我们小结一下前面介绍的所有本构模型，<a class="reference internal" href="#tab-animation-elastomers-constitutive-models"><span class="std std-numref">表 21.1</span></a> 总结了所有模型的优缺点，在了解每个模型的性质之后我们应当根据模拟的需求适当地选择。</p>
<div class="pst-scrollable-table-container"><table class="table table-center" id="tab-animation-elastomers-constitutive-models">
<caption><span class="caption-number">表 21.1 </span><span class="caption-text">各种本构模型</span><a class="headerlink" href="#tab-animation-elastomers-constitutive-models" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head text-center"><p>名称</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\Psi\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol P\)</span></p></th>
<th class="head text-center"><p>模拟效率</p></th>
<th class="head text-center"><p>旋转不变性</p></th>
<th class="head text-center"><p>各向同性</p></th>
<th class="head text-center"><p>能处理强压缩</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>线性模型</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\mu\mathrm{tr}\left(\boldsymbol\epsilon^2\right)+\frac\lambda 2\mathrm{tr}^2(\boldsymbol\epsilon)\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2\mu\boldsymbol\epsilon+\lambda\mathrm{tr}(\boldsymbol\epsilon)\mathbf I\)</span></p></td>
<td class="text-center"><p>高</p></td>
<td class="text-center"><p>无</p></td>
<td class="text-center"><p>无</p></td>
<td class="text-center"><p>否</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>圣维南-基尔霍夫模型</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\mu\mathrm{tr}\left(\boldsymbol E^2\right)+\frac\lambda 2\mathrm{tr}^2(\boldsymbol E)\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol F[2\mu\boldsymbol E+\lambda\mathrm{tr}(\boldsymbol E)\mathbf I]\)</span></p></td>
<td class="text-center"><p>低</p></td>
<td class="text-center"><p>有</p></td>
<td class="text-center"><p>有</p></td>
<td class="text-center"><p>否</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>共旋转线性模型</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\mu\Vert\boldsymbol S-\mathbf I\Vert_\mathrm F^2+\frac\lambda 2\mathrm{tr}^2(\boldsymbol S-\mathbf I)\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2\mu(\boldsymbol F-\boldsymbol R)+\lambda\mathrm{tr}\left(\boldsymbol R^\top\boldsymbol F-\mathbf I\right)\boldsymbol R\)</span></p></td>
<td class="text-center"><p>中</p></td>
<td class="text-center"><p>有</p></td>
<td class="text-center"><p>有</p></td>
<td class="text-center"><p>否</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>新胡克模型</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac\mu 2[I_1-\log(I_3)-3]+\frac\lambda 8\log^2(I_3)\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\mu\boldsymbol F-\mu\boldsymbol F^{-\top}+\frac{\lambda\log(I_3)}2\boldsymbol F^{-\top}\)</span></p></td>
<td class="text-center"><p>低</p></td>
<td class="text-center"><p>有</p></td>
<td class="text-center"><p>有</p></td>
<td class="text-center"><p>是</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<section id="sec-animation-elastomers-fem-discretization">
<span id="id16"></span><h2><span class="section-number">21.2.2. </span>空间离散化<a class="headerlink" href="#sec-animation-elastomers-fem-discretization" title="Link to this heading">#</a></h2>
<p>我们在前文讲到的所有物理模型都是建立在连续体上的，与弹簧质点系统一样，要使用计算机将这些物理模型模拟出来也需要进行空间离散化。在有限元方法中，一个连续的超弹性材料被表示成一个四面体网格（tetrahedral mesh），即一些紧密相连的四面体组成的图（如<a class="reference internal" href="#fig-animation-elastomers-hand"><span class="std std-numref">图 21.13</span></a> 所示）。</p>
<figure class="align-default" id="fig-animation-elastomers-hand">
<img alt="../../_images/animation-elastomers-hand.png" src="../../_images/animation-elastomers-hand.png" />
<figcaption>
<p><span class="caption-number">图 21.13 </span><span class="caption-text">一个手形弹性体分别在有限元方法（左）和弹簧质点系统（右）中的离散化</span><a class="headerlink" href="#fig-animation-elastomers-hand" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>设四面体网格拥有 <span class="math notranslate nohighlight">\(N\)</span> 个顶点和 <span class="math notranslate nohighlight">\(M\)</span> 个四面体单元，离散化后的弹性体的全部自由度即为所有四面体的顶点，我们记未形变状态下顶点的坐标为 <span class="math notranslate nohighlight">\(\boldsymbol X_1,\cdots,\boldsymbol X_N\)</span>，形变后的顶点坐标为 <span class="math notranslate nohighlight">\(\boldsymbol x_1,\cdots,\boldsymbol x_N\)</span>。利用这些自由度，我们需要构造出一个合适的变形函数 <span class="math notranslate nohighlight">\(\boldsymbol\phi(\boldsymbol X)\)</span>，使其满足 <span class="math notranslate nohighlight">\(\boldsymbol\phi(\boldsymbol X_i)=\boldsymbol x_i,i=1,\cdots,N\)</span>；这样，我们就从离散的定点上定义的变形映射延拓到了一个连续区域内，便可以进一步地计算出形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F\)</span>，再结合本构模型计算出 <span class="math notranslate nohighlight">\(\Psi\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol P\)</span>。但是，在离散意义下，我们并不能简单地使用 <a class="reference internal" href="#sec-animation-elastomers-fem-energy-force"><span class="std std-numref">§21.2.1.4</span></a> 中的方法计算到的力密度和牵引力去更新弹性体的状态；因为在离散化之后，我们只能够通过更新这 <span class="math notranslate nohighlight">\(N\)</span> 个顶点的位置来实现弹性体的动态，定义在连续域上的力密度和牵引力就不能直接使用了；我们的方法是利用力密度的积分计算总能量，然后将整个弹性体的质量分配在每个顶点上，每个顶点的受力就变成负能量梯度了。接下来，我们将一一讲述这些步骤。</p>
<section id="id17">
<h3><span class="section-number">21.2.2.1. </span>变形函数的选择<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<p>我们假设每个四面体单元都只能经历线性形变，即在任意一个四面体 <span class="math notranslate nohighlight">\(\mathcal T_i\)</span> 内部，变形函数都是线性函数。因此，整个变形函数 <span class="math notranslate nohighlight">\(\boldsymbol\phi\)</span> 可以表示为一个分段线性函数：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-discrete-deformation-map">
<span class="eqno">(21.34)<a class="headerlink" href="#equation-animation-elastomers-discrete-deformation-map" title="Link to this equation">#</a></span>\[
\boldsymbol\phi(\boldsymbol X)=\boldsymbol A_i\boldsymbol X+\boldsymbol b_i,\quad\boldsymbol X\in\mathcal T_i,\quad\quad i=1,\cdots,M，
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol A_i\in\mathbb R^{3\times 3}\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol b_i\in\mathbb R^3\)</span> 刻画了第 <span class="math notranslate nohighlight">\(i\)</span> 个四面体经历的线性变换。通过对式 <a class="reference internal" href="#equation-animation-elastomers-discrete-deformation-map">(21.34)</a> 两端关于 <span class="math notranslate nohighlight">\(\boldsymbol X\)</span> 求导，可以得到每个四面体内的形变梯度：</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol F(\boldsymbol X)=\boldsymbol A_i,\quad\boldsymbol X\in\mathcal T_i,\quad\quad i=1,\cdots,M，
\]</div>
<p>因此在后文我们记四面体 <span class="math notranslate nohighlight">\(i\)</span> 的形变梯度为 <span class="math notranslate nohighlight">\(\boldsymbol F_i\)</span>，式 <a class="reference internal" href="#equation-animation-elastomers-discrete-deformation-map">(21.34)</a> 又可以写为</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-discrete-deformation-map2">
<span class="eqno">(21.35)<a class="headerlink" href="#equation-animation-elastomers-discrete-deformation-map2" title="Link to this equation">#</a></span>\[
\boldsymbol\phi(\boldsymbol X)=\boldsymbol F_i\boldsymbol X+\boldsymbol b_i,\quad\boldsymbol X\in\mathcal T_i,\quad\quad i=1,\cdots,M。
\]</div>
</section>
<section id="id18">
<h3><span class="section-number">21.2.2.2. </span>形变梯度的计算<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<p>接下来的目标就是将式 <a class="reference internal" href="#equation-animation-elastomers-discrete-deformation-map2">(21.35)</a> 中的 <span class="math notranslate nohighlight">\(\boldsymbol F_1,\cdots,\boldsymbol F_M\)</span> 计算出来。对于一个四面体 <span class="math notranslate nohighlight">\(i\)</span>，我们可以通过它四个顶点形变前和形变后的位置列出如下的方程：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\boldsymbol x_i^1=\boldsymbol F_i\boldsymbol X_i^1+\boldsymbol b_i\\
\boldsymbol x_i^2=\boldsymbol F_i\boldsymbol X_i^2+\boldsymbol b_i\\
\boldsymbol x_i^3=\boldsymbol F_i\boldsymbol X_i^3+\boldsymbol b_i\\
\boldsymbol x_i^4=\boldsymbol F_i\boldsymbol X_i^4+\boldsymbol b_i
\end{cases}，
\end{split}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol X_i^{1,2,3,4}\)</span> 代表四面体 <span class="math notranslate nohighlight">\(i\)</span> 的四个顶点在参考构型下的位置，<span class="math notranslate nohighlight">\(\boldsymbol x_i^{1,2,3,4}\)</span> 代表四个顶点形变后的位置。通过等式的作差我们可以将此方程组中不关心的未知量 <span class="math notranslate nohighlight">\(\boldsymbol b_i\)</span> 去掉：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\boldsymbol x_i^1-\boldsymbol x_i^4=\boldsymbol F_i(\boldsymbol X_i^1-\boldsymbol X_i^4)\\
\boldsymbol x_i^2-\boldsymbol x_i^4=\boldsymbol F_i(\boldsymbol X_i^2-\boldsymbol X_i^4)\\
\boldsymbol x_i^3-\boldsymbol x_i^4=\boldsymbol F_i(\boldsymbol X_i^3-\boldsymbol X_i^4)
\end{cases}。
\end{split}\]</div>
<p>这三个等式又可以写成矩阵形式</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-deform-mat-equation">
<span class="eqno">(21.36)<a class="headerlink" href="#equation-animation-elastomers-deform-mat-equation" title="Link to this equation">#</a></span>\[
\boldsymbol D_\mathrm s=\boldsymbol F_i\boldsymbol D_\mathrm m，
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm s=\begin{bmatrix}x_i^1-x_i^4&amp;x_i^2-x_i^4&amp;x_i^3-x_i^4\\ y_i^1-y_i^4&amp;y_i^2-y_i^4&amp;y_i^3-y_i^4\\ z_i^1-z_i^4&amp;z_i^2-z_i^4&amp;z_i^3-z_i^4\end{bmatrix}\)</span> 为变形形状矩阵（deformed shape matrix），<span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm m=\begin{bmatrix}X_i^1-X_i^4&amp;X_i^2-X_i^4&amp;X_i^3-X_i^4\\ Y_i^1-Y_i^4&amp;Y_i^2-Y_i^4&amp;Y_i^3-Y_i^4\\ Z_i^1-Z_i^4&amp;Z_i^2-Z_i^4&amp;Z_i^3-Z_i^4\end{bmatrix}\)</span> 为参考形状矩阵（reference shape matrix）或材料空间形状矩阵（material-space shape matrix），因为我们称形变后的空间为材料空间。值得注意的是，这里的 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm s\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm m\)</span> 都是和四面体有关的，为了符号简便我们省略了 <span class="math notranslate nohighlight">\(i\)</span> 这个角标。</p>
<p>由式 <a class="reference internal" href="#equation-animation-elastomers-deform-mat-equation">(21.36)</a> 我们可以立刻计算出形变梯度矩阵：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-calc-deform-grad">
<span class="eqno">(21.37)<a class="headerlink" href="#equation-animation-elastomers-calc-deform-grad" title="Link to this equation">#</a></span>\[
\boldsymbol F_i=\boldsymbol D_\mathrm s\boldsymbol D_\mathrm m^{-1}。
\]</div>
<p>虽然这里需要求矩阵的逆，但是由于 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm m\)</span> 只与弹性体的参考构型有关，我们可以将它们的逆提前计算好并存储下来，从而不需要在模拟过程中额外计算。</p>
</section>
<section id="id19">
<h3><span class="section-number">21.2.2.3. </span>能量与力的计算<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<p>其实，在我们选择好变形函数之后，就能够通过式 <a class="reference internal" href="#equation-animation-elastomers-energy">(21.19)</a> 得到离散化后的能量了：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-discrete-energy">
<span class="eqno">(21.38)<a class="headerlink" href="#equation-animation-elastomers-discrete-energy" title="Link to this equation">#</a></span>\[
E=\int_\Omega\Psi(\boldsymbol F(\boldsymbol X))\mathrm d\boldsymbol X=\sum_{i=1}^M\int_{\mathcal T_i}\Psi(\boldsymbol F_i)\mathrm d\boldsymbol X=\sum_{i=1}^MW_i\Psi(\boldsymbol F_i)，
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(W_i=\frac 16\vert\det\boldsymbol D_\mathrm m\vert\)</span> 为标准构型下四面体 <span class="math notranslate nohighlight">\(\mathcal T_i\)</span> 的体积，与 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm m\)</span> 一样，它也是一个可以提前计算好的量。</p>
<div class="admonition hint">
<p class="admonition-title">提示</p>
<p>我们知道，四面体的体积等于底面积乘以高的三分之一。因此对于四面体 <span class="math notranslate nohighlight">\(\mathcal T_i\)</span>，如果我们将它的 <span class="math notranslate nohighlight">\(2,3,4\)</span> 号顶点组成的三角形视为底面的话，它的面积可以写成 <span class="math notranslate nohighlight">\(\frac 13\left(\left\vert\frac 12(\boldsymbol X_i^3-\boldsymbol X_i^4)\times(\boldsymbol X_i^2-\boldsymbol X_i^4)\right\vert\cdot(\boldsymbol X_i^1-\boldsymbol X_i^4)\right)\)</span>，由此读者不难推出文中 <span class="math notranslate nohighlight">\(W_i\)</span> 的形式。</p>
</div>
<p>式 <a class="reference internal" href="#equation-animation-elastomers-discrete-energy">(21.38)</a> 中的能量可以看成一个关于所有自由度 <span class="math notranslate nohighlight">\(\boldsymbol x_1,\cdots,\boldsymbol x_N\)</span> 的函数，简记为 <span class="math notranslate nohighlight">\(E(\boldsymbol x)\)</span>。在离散意义下，我们可以假设每个四面体的质量都平均分配给了它的四个顶点，那么由这些顶点的机械能守恒，我们可以知道每个顶点 <span class="math notranslate nohighlight">\(j\)</span> 的受力就是势能 <span class="math notranslate nohighlight">\(E(\boldsymbol x)\)</span> 关于其位置 <span class="math notranslate nohighlight">\(\boldsymbol x_j\)</span> 的负梯度，即 <span class="math notranslate nohighlight">\(\boldsymbol f_j=-\frac{\partial E(\boldsymbol x)}{\partial\boldsymbol x_j}\)</span>。</p>
<p>为方便推导出每个顶点受力的具体形式，我们考察每个四面体为它四个顶点贡献的力。记四面体 <span class="math notranslate nohighlight">\(i\)</span> 的能量为 <span class="math notranslate nohighlight">\(E_i=W_i\Psi(\boldsymbol F_i)\)</span>，四面体对它的第 <span class="math notranslate nohighlight">\(j\)</span> 个顶点贡献的力为 <span class="math notranslate nohighlight">\(\boldsymbol f_i^j=-\frac{\partial E_i}{\partial\boldsymbol x_i^j}\)</span>。通过对 <span class="math notranslate nohighlight">\(E_i\)</span> 关于 <span class="math notranslate nohighlight">\(\boldsymbol x_i^{1,2,3,4}\)</span> 分别求导我们可以得到这些力的值：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-discrete-force">
<span class="eqno">(21.39)<a class="headerlink" href="#equation-animation-elastomers-discrete-force" title="Link to this equation">#</a></span>\[\begin{split}
&amp;\boldsymbol H_i\mathrel{\mathop:}=\begin{bmatrix}\boldsymbol f_i^1&amp;\boldsymbol f_i^2&amp;\boldsymbol f_i^3\end{bmatrix}=-W_i\boldsymbol P(\boldsymbol F_i)\boldsymbol D_\mathrm m^{-\top}，\\
&amp;\boldsymbol f_i^4=-\boldsymbol f_i^1-\boldsymbol f_i^2-\boldsymbol f_i^3。
\end{split}\]</div>
<p>因此，我们只需要对于每个四面体计算好它对四个顶点的力的贡献，并将其累加到四个顶点的受力上，即可得到完整的弹性力。</p>
</section>
</section>
<section id="id20">
<h2><span class="section-number">21.2.3. </span>数值求解算法<a class="headerlink" href="#id20" title="Link to this heading">#</a></h2>
<section id="sec-animation-elastomers-fem-explicit-euler">
<span id="id21"></span><h3><span class="section-number">21.2.3.1. </span>显式时间积分<a class="headerlink" href="#sec-animation-elastomers-fem-explicit-euler" title="Link to this heading">#</a></h3>
<p>我们可以按照 <a class="reference internal" href="#sec-animation-elastomers-fem-discretization"><span class="std std-numref">§21.2.2</span></a> 计算弹性体在一个状态下的弹性力，然后在加上外力，即可进行显式时间积分的模拟。我们在这里通过模拟的过程对上述弹性体各个量的计算进行一个小结：</p>
<ol class="arabic simple">
<li><p>对参考构型下的每一个四面体，计算参考形状矩阵 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm m\)</span>、它的逆 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm m^{-1}\)</span> 以及四面体的体积 <span class="math notranslate nohighlight">\(W_i\)</span>。</p></li>
<li><p>计算每个顶点分配到的质量 <span class="math notranslate nohighlight">\(m_i\)</span>。</p></li>
<li><p>对每一个顶点施加外力：<span class="math notranslate nohighlight">\(\boldsymbol v_i\gets\boldsymbol v_i+\frac h{m_i}\boldsymbol f_i^{\mathrm{ext}}\)</span>。</p></li>
<li><p>准备弹性力向量 <span class="math notranslate nohighlight">\(\boldsymbol f\gets\mathbf 0\in\mathbb R^{3N}\)</span>，它表示所有顶点的弹性力堆叠而成的向量。</p></li>
<li><p>循环遍历每一个四面体，设四面体 <span class="math notranslate nohighlight">\(i\in\{1,\cdots,M\}\)</span> 的四个顶点编号分别为 <span class="math notranslate nohighlight">\(a,b,c,d\)</span>（请注意，这四个顶点的顺序很重要）：</p>
<ul class="simple">
<li><p>计算变形形状矩阵 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm s\)</span>、形变梯度 <span class="math notranslate nohighlight">\(\boldsymbol F_i\)</span> 以及 <span class="math notranslate nohighlight">\(\boldsymbol P(\boldsymbol F_i)\)</span>。</p></li>
<li><p>计算四面体对每个顶点的弹性力贡献 <span class="math notranslate nohighlight">\(\boldsymbol H_i\gets-W_i\boldsymbol P(\boldsymbol F_i)\boldsymbol D_\mathrm m^{-\top}\)</span>，设 <span class="math notranslate nohighlight">\(\begin{bmatrix}\boldsymbol h_1&amp;\boldsymbol h_2&amp;\boldsymbol h_3\end{bmatrix}=\boldsymbol H_i\)</span>。</p></li>
<li><p>更新弹性力向量：<span class="math notranslate nohighlight">\(\boldsymbol f_a\gets\boldsymbol f_a+\boldsymbol h_1\)</span>，<span class="math notranslate nohighlight">\(\boldsymbol f_b\gets\boldsymbol f_b+\boldsymbol h_2\)</span>，<span class="math notranslate nohighlight">\(\boldsymbol f_c\gets\boldsymbol f_c+\boldsymbol h_3\)</span>，<span class="math notranslate nohighlight">\(\boldsymbol f_d\gets\boldsymbol f_d-\boldsymbol h_1-\boldsymbol h_2-\boldsymbol h_3\)</span>。</p></li>
</ul>
</li>
<li><p>对每一个顶点施加弹性力：<span class="math notranslate nohighlight">\(\boldsymbol v_i\gets\boldsymbol v_i+\frac h{m_i}\boldsymbol f_i\)</span>。</p></li>
<li><p>对于每一个顶点，使用速度更新位置：<span class="math notranslate nohighlight">\(\boldsymbol x_i\gets\boldsymbol x_i+h\boldsymbol v_i\)</span>。</p></li>
<li><p>进入下一个时间步，回到第 3 步。</p></li>
</ol>
<p>以上的 <span class="math notranslate nohighlight">\(h\)</span> 表示时间步长，<span class="math notranslate nohighlight">\(m_i\)</span> 表示顶点 <span class="math notranslate nohighlight">\(i\)</span> 分配到的总质量，请注意每个顶点的质量并不相同，取决于它和那些四面体相关。第 1 和 2 步是模拟的预计算过程，第 2 到 7 步是一个时间步的时间积分，不断循环以模拟出每个时间步之后弹性体的状态。和弹簧质点系统一样，显式时间积分是非常不稳定的，很容易产生数值爆炸，除非你用很小的时间步长模拟，代价就是要花费大量的时间模拟同样长的一段动态。为了让弹性体的模拟更加稳定，我们需要使用隐式时间积分，并在系统中引入阻尼，这些都会在接下来进行介绍。</p>
</section>
<section id="id22">
<h3><span class="section-number">21.2.3.2. </span>隐式时间积分<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<p>与弹簧质点系统类似，弹簧有劲度系数，弹性体也有相应的劲度矩阵（stiffness matrix）。为了了解这个概念，我们先回顾一下一根弹簧对质点的弹力是什么样的。为了简便，我们假设整个系统在一维空间下，弹簧的一端固定在原点，另一端连接着一个位置为 <span class="math notranslate nohighlight">\(x(x&gt;0)\)</span> 的质点，弹簧的原长为 <span class="math notranslate nohighlight">\(l\)</span>、劲度系数为 <span class="math notranslate nohighlight">\(k\)</span>，那么质点受到的弹力为 <span class="math notranslate nohighlight">\(f=-k(x-l)\)</span>。我们知道劲度系数反应了弹簧的“坚硬程度”，但是这个坚硬程度的具体含义是什么呢？从弹力的形式我们不难看出，<span class="math notranslate nohighlight">\(k=-\frac{\partial f}{\partial x}\)</span> 反映了力随位置的变化速率，这个变化速率越快，拉长或压缩一单位距离的弹簧，所受到的弹性阻碍的增量也越多，弹簧就越“硬”。将弹簧的劲度系数拓展到有限元四面体网格的情形，我们就能够得到劲度矩阵的定义——劲度矩阵即为所有顶点的弹性力关于顶点位置的负雅可比矩阵：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-stiffness-matrix">
<span class="eqno">(21.40)<a class="headerlink" href="#equation-animation-elastomers-stiffness-matrix" title="Link to this equation">#</a></span>\[
\boldsymbol K(\boldsymbol x)=-\frac{\partial\boldsymbol f(\boldsymbol x)}{\partial\boldsymbol x}，
\]</div>
<p>这里的 <span class="math notranslate nohighlight">\(\boldsymbol f\)</span> 继承了 <a class="reference internal" href="#sec-animation-elastomers-fem-explicit-euler"><span class="std std-numref">§21.2.3.1</span></a> 中的含义，表示所有顶点受到的弹性力堆叠而成的向量。</p>
<p>通过劲度矩阵，我们可以立即给出阻尼力（damping force）的定义：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-damping">
<span class="eqno">(21.41)<a class="headerlink" href="#equation-animation-elastomers-damping" title="Link to this equation">#</a></span>\[
\boldsymbol f_\mathrm d(\boldsymbol x,\boldsymbol v)=-\gamma\boldsymbol K(\boldsymbol x)\boldsymbol v，
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol v\)</span> 表示顶点的速度，<span class="math notranslate nohighlight">\(\boldsymbol f_\mathrm d,\boldsymbol v\)</span> 都是类似 <span class="math notranslate nohighlight">\(\boldsymbol x\)</span> 的堆叠向量。在本节，如无特殊说明，所有向量均为这样的堆叠向量。</p>
<p>我们回顾一下弹簧质点系统中介绍过的隐式时间积分的概念，就是使用时间步末端时刻的状态来近似整个时间步内的量，例如从时间步 <span class="math notranslate nohighlight">\(k\)</span> 到 <span class="math notranslate nohighlight">\(k+1\)</span> 的隐式时间积分可以写为如下方程组：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-implicit-euler-x">
<span class="eqno">(21.42)<a class="headerlink" href="#equation-animation-elastomers-implicit-euler-x" title="Link to this equation">#</a></span>\[
\boldsymbol x^{k+1}=\boldsymbol x^k+h\boldsymbol v^{k+1}，
\]</div>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-implicit-euler-v">
<span class="eqno">(21.43)<a class="headerlink" href="#equation-animation-elastomers-implicit-euler-v" title="Link to this equation">#</a></span>\[
\boldsymbol v^{k+1}=\boldsymbol v^k+h\boldsymbol M^{-1}\left(\boldsymbol f(\boldsymbol x^{k+1})+\boldsymbol f_\mathrm d(\boldsymbol x^{k+1},\boldsymbol v^{k+1})\right)，
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol M=\mathrm{diag}\{m_1,m_1,m_1,m_2,m_2,m_2,\cdots,m_N,m_N,m_N\}\)</span> 为质量矩阵。这里为了简便，我们忽略了外力，事实上我们可以认为外力项包含在了 <span class="math notranslate nohighlight">\(\boldsymbol v^k\)</span> 内。</p>
<p>为求解这个方程组，我们同样使用迭代法来求解 <span class="math notranslate nohighlight">\(\boldsymbol x^{k+1}\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol v^{k+1}\)</span>，也就是说我们的求解器会产生两个序列 <span class="math notranslate nohighlight">\(\{\boldsymbol x_{(i)}\}_{i=1}^\infty\)</span> 和 <span class="math notranslate nohighlight">\(\{\boldsymbol v_{(i)}\}_{i=1}^\infty\)</span>，使得 <span class="math notranslate nohighlight">\(\lim_{i\to\infty}\boldsymbol x_{(i)}=\boldsymbol x^{k+1}\)</span>，<span class="math notranslate nohighlight">\(\lim_{i\to\infty}\boldsymbol v_{(i)}=\boldsymbol v^{k+1}\)</span>。我们将时间步开始时刻的状态作为求解算法的初始值，即 <span class="math notranslate nohighlight">\(\boldsymbol x_{(0)}=\boldsymbol x^k\)</span>，<span class="math notranslate nohighlight">\(\boldsymbol v_{(0)}=\boldsymbol v^k\)</span>，然后每一个迭代由 <span class="math notranslate nohighlight">\(\boldsymbol x_{(i)},\boldsymbol v_{(i)}\)</span> 推出 <span class="math notranslate nohighlight">\(\boldsymbol x_{(i+1)},\boldsymbol v_{(i+1)}\)</span>，对式 <a class="reference internal" href="#equation-animation-elastomers-implicit-euler-v">(21.43)</a> 中的弹性力在 <span class="math notranslate nohighlight">\((\boldsymbol x_{(i)},\boldsymbol v_{(i)})\)</span> 处进行泰勒展开可以得到：</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol v^{k+1}=\boldsymbol v^k+h\boldsymbol M^{-1}\left(\boldsymbol f(\boldsymbol x_{(i)})+\frac{\partial\boldsymbol f(\boldsymbol x_{(i)})}{\partial\boldsymbol x}(\boldsymbol x^{k+1}-\boldsymbol x_{(i)})-\gamma\boldsymbol K(\boldsymbol x_{(i)})\boldsymbol v^{k+1}\right)，
\]</div>
<p>这里我们对阻尼力的处理是代入 <span class="math notranslate nohighlight">\(\boldsymbol f_\mathrm d(\boldsymbol x_{(i)},\boldsymbol v^{k+1})\)</span>，这是为了避免对劲度矩阵 <span class="math notranslate nohighlight">\(\boldsymbol K\)</span> 进行泰勒展开，因为它的导数将会是一个三阶张量，为求解器带来极大的计算量。在当前迭代中，我们的目标就是求出这个泰勒展开后的方程关于 <span class="math notranslate nohighlight">\(\boldsymbol x^{k+1}\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol v^{k+1}\)</span> 的解，所以我们可以将 <span class="math notranslate nohighlight">\(\boldsymbol x_{(i+1)}=\boldsymbol x^{k+1}\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol v_{(i+1)}=\boldsymbol v^{k+1}\)</span> 代入泰勒展开后的方程，再令 <span class="math notranslate nohighlight">\(\Delta\boldsymbol x_{(i)}=\boldsymbol x_{(i+1)}-\boldsymbol x_{(i)}\)</span>，<span class="math notranslate nohighlight">\(\Delta\boldsymbol v_{(i)}=\boldsymbol v_{(i+1)}-\boldsymbol v_{(i)}\)</span>，得到</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol v_{(i)}+\Delta\boldsymbol v=\boldsymbol v^k+h\boldsymbol M^{-1}\left(\boldsymbol f(\boldsymbol x_{(i)})+\boldsymbol K(\boldsymbol x_{(i)})\Delta\boldsymbol x-\gamma\boldsymbol K(\boldsymbol x_{(i)})(\boldsymbol v_{(i)}+\Delta\boldsymbol v)\right)。
\]</div>
<p>再利用式 <a class="reference internal" href="#equation-animation-elastomers-implicit-euler-x">(21.42)</a> 将方程表示成仅关于 <span class="math notranslate nohighlight">\(\Delta\boldsymbol x\)</span> 的：</p>
<div class="math notranslate nohighlight">
\[
\frac 1{h^2}\boldsymbol M\Delta\boldsymbol x=\frac 1h\boldsymbol M(\boldsymbol v^k-\boldsymbol v_{(i)})+\left(\boldsymbol f(\boldsymbol x_{(i)})-\boldsymbol K(\boldsymbol x_{(i)})\Delta\boldsymbol x-\gamma\boldsymbol K(\boldsymbol x_{(i)})\left(\boldsymbol v_{(i)}+\frac 1h\Delta\boldsymbol x\right)\right)，
\]</div>
<p>于是得到这样一个线性系统：</p>
<div class="math notranslate nohighlight" id="equation-animation-elastomers-linear-system">
<span class="eqno">(21.44)<a class="headerlink" href="#equation-animation-elastomers-linear-system" title="Link to this equation">#</a></span>\[
\left[\left(1+\frac\gamma h\right)\boldsymbol K(\boldsymbol x_{(i)})+\frac 1{h^2}\boldsymbol M\right]\Delta\boldsymbol x=\frac 1h\boldsymbol M(\boldsymbol v^k-\boldsymbol v_{(i)})+\left(\boldsymbol f(\boldsymbol x_{(i)})-\gamma\boldsymbol K(\boldsymbol x_{(i)})\boldsymbol v_{(i)}\right)。
\]</div>
<p>如果能解出 <span class="math notranslate nohighlight">\(\Delta\boldsymbol x\)</span>，我们就可以进行本轮迭代的更新：<span class="math notranslate nohighlight">\(\boldsymbol x_{(i+1)}=\boldsymbol x_{(i)}+\Delta\boldsymbol x\)</span>，<span class="math notranslate nohighlight">\(\boldsymbol v_{(i+1)}=\boldsymbol v_{(i)}+\frac 1h\Delta\boldsymbol x\)</span>。一般来讲，重复 2 到 3 步这样的迭代就足以模拟出很真实的弹性效果了。</p>
<p>求解式 <a class="reference internal" href="#equation-animation-elastomers-linear-system">(21.44)</a> 的线性系统需要格外关注一个事实：劲度矩阵 <span class="math notranslate nohighlight">\(\boldsymbol K(\boldsymbol x_{(i)})\)</span> 的表达式十分复杂，我们希望能够通过无矩阵（matrix-free）的方式求解这个系统。幸运的是，许多线性求解器是支持无矩阵求解的，例如无矩阵的共轭梯度法（matrix-free conjugate gradient method），这类方法一般只需要你提供一个接口，对于任何输入的向量 <span class="math notranslate nohighlight">\(\boldsymbol x\)</span>，能够输出 <span class="math notranslate nohighlight">\(\boldsymbol{Ax}\)</span>，这里的 <span class="math notranslate nohighlight">\(\boldsymbol A\)</span> 是线性系统的矩阵。那么根据式 <a class="reference internal" href="#equation-animation-elastomers-linear-system">(21.44)</a>，我们想提供接口只需要能够计算 <span class="math notranslate nohighlight">\(\boldsymbol K(\boldsymbol x_{(i)})\boldsymbol x\)</span> 即可。</p>
<p>考虑在 <span class="math notranslate nohighlight">\(\boldsymbol x_{(i)}\)</span> 基础上的任意一段微小的位移 <span class="math notranslate nohighlight">\(\delta\boldsymbol x\)</span>，它所导致的弹性力的变化为 <span class="math notranslate nohighlight">\(\delta\boldsymbol f=\frac{\partial\boldsymbol f(\boldsymbol x_{(i)})}{\partial\boldsymbol x}\delta\boldsymbol x=-\boldsymbol K(\boldsymbol x_{(i)})\delta\boldsymbol x\)</span>，所以只要我们能够计算出 <span class="math notranslate nohighlight">\(\delta\boldsymbol f\)</span> 就能够提供这样的接口。</p>
<p>为求 <span class="math notranslate nohighlight">\(\delta\boldsymbol f\)</span>，我们还是回到单个四面体 <span class="math notranslate nohighlight">\(i\)</span> 对力的贡献，即求 <span class="math notranslate nohighlight">\(\delta\boldsymbol H_i=\begin{bmatrix}\delta\boldsymbol f_i^1&amp;\delta\boldsymbol f_i^2&amp;\delta\boldsymbol f_i^3\end{bmatrix}\)</span>，那么 <span class="math notranslate nohighlight">\(\delta\boldsymbol f_i^4=-\delta\boldsymbol f_i^1-\delta\boldsymbol f_i^2-\delta\boldsymbol f_i^3\)</span>，随后我们将 <span class="math notranslate nohighlight">\(\delta\boldsymbol f_i^{1,2,3,4}\)</span> 分别加到 <span class="math notranslate nohighlight">\(\delta\boldsymbol f\)</span> 的对应位置上即可（类似 <a class="reference internal" href="#sec-animation-elastomers-fem-explicit-euler"><span class="std std-numref">§21.2.3.1</span></a> 中计算弹性力的过程）。通过对式 <a class="reference internal" href="#equation-animation-elastomers-discrete-force">(21.39)</a> 两边求微分可得</p>
<div class="math notranslate nohighlight">
\[
\delta\boldsymbol H_i=-W_i\delta\boldsymbol P(\boldsymbol F_i;\delta\boldsymbol F_i)\boldsymbol D_\mathrm m^{-\top}，
\]</div>
<p>这是因为 <span class="math notranslate nohighlight">\(W_i\)</span> 和 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm m^{-\top}\)</span> 都与形变后的四面体顶点位置无关。这里将应力张量的微分写成这个形式是为了突出其表达式中会显含 <span class="math notranslate nohighlight">\(\boldsymbol F_i\)</span> 和 <span class="math notranslate nohighlight">\(\delta\boldsymbol F_i\)</span>，但严格来讲 <span class="math notranslate nohighlight">\(\delta\boldsymbol F_i\)</span> 也是一个关于 <span class="math notranslate nohighlight">\(\boldsymbol F_i\)</span> 的函数，<span class="math notranslate nohighlight">\(\delta\boldsymbol P(\boldsymbol F;\delta\boldsymbol F)\)</span> 的具体形式取决于你选择的本构模型，我们会在本节的最后给出常用的两种。那么剩下的就是求出 <span class="math notranslate nohighlight">\(\delta\boldsymbol F_i\)</span> 了，由式 <a class="reference internal" href="#equation-animation-elastomers-calc-deform-grad">(21.37)</a> 可得</p>
<div class="math notranslate nohighlight">
\[
\delta\boldsymbol F=(\delta\boldsymbol D_\mathrm s)\boldsymbol D_\mathrm m^{-1}，
\]</div>
<p>而 <span class="math notranslate nohighlight">\(\boldsymbol D_\mathrm s\)</span> 就是由位置坐标组成的矩阵，所以它的微分十分简单：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\delta\boldsymbol D_\mathrm s=\begin{bmatrix}\delta x_i^1-\delta x_i^4&amp;\delta x_i^2-\delta x_i^4&amp;\delta x_i^3-\delta x_i^4\\\delta y_i^1-\delta y_i^4&amp;\delta y_i^2-\delta y_i^4&amp;\delta y_i^3-\delta y_i^4\\\delta z_i^1-\delta z_i^4&amp;\delta z_i^2-\delta z_i^4&amp;\delta z_i^3-\delta z_i^4\end{bmatrix}。
\end{split}\]</div>
<p>下面我们分别给出圣维南-基尔霍夫模型和新胡克模型下的第一类皮奥拉-基尔霍夫应力张量的微分。首先，格林应变张量的微分是</p>
<div class="math notranslate nohighlight">
\[
\delta\boldsymbol E=\frac 12(\delta\boldsymbol F^\top\boldsymbol F+\boldsymbol F^\top\delta\boldsymbol F)，
\]</div>
<p>进而给出圣维南-基尔霍夫模型下应变张量的微分：</p>
<div class="math notranslate nohighlight">
\[
\delta\boldsymbol P(\boldsymbol F;\delta\boldsymbol F)=\delta\boldsymbol F[2\mu\boldsymbol E+\lambda\mathrm{tr}(\boldsymbol E)\mathbf I]+\boldsymbol F[2\mu\delta\boldsymbol E+\lambda\mathrm{tr}(\delta\boldsymbol E)\mathbf I]。
\]</div>
<p>接下来我们不加证明地给出一些矩阵变换下的微分的形式，矩阵的逆的微分为 <span class="math notranslate nohighlight">\(\delta[\boldsymbol F^{-1}]=-\boldsymbol F^{-1}\delta\boldsymbol F\boldsymbol F^{-1}\)</span>，矩阵的逆的转至的微分为 <span class="math notranslate nohighlight">\(\delta[\boldsymbol F^{-\top}]=-\boldsymbol F^{-\top}\delta\boldsymbol F^\top\boldsymbol F^{-\top}\)</span>，矩阵行列式的微分为 <span class="math notranslate nohighlight">\(\delta[\det\boldsymbol F]=\det\boldsymbol F\cdot\mathrm{tr}(\boldsymbol F^{-1}\delta\boldsymbol F)\)</span>。借助这些我们可以得出新胡克模型下应变张量的微分：</p>
<div class="math notranslate nohighlight">
\[
\delta\boldsymbol P(\boldsymbol F;\delta\boldsymbol F)=\mu\delta\boldsymbol F+[\mu-\lambda\log J]\boldsymbol F^{-\top}\delta\boldsymbol F^\top\boldsymbol F^{-\top}+\lambda\mathrm{tr}(\boldsymbol F^{-1}\delta\boldsymbol F)\boldsymbol F^{-\top}，
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(J=\sqrt{I_3}=\det\boldsymbol F\)</span>。</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="fig-animation-elastomers-isotropic-anisotropic-material-ref" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id14">1</a><span class="fn-bracket">]</span></span>
<p>金属、橡胶、肌肉、木材四幅图片均来自维基百科，网址分别为 https://en.wikipedia.org/wiki/Nut_(hardware)、https://en.wikipedia.org/wiki/Tire、https://zh.wikipedia.org/wiki/%E8%82%B1%E4%BA%8C%E9%A0%AD%E8%82%8C 和 https://zh.wikipedia.org/zh-cn/%E6%9C%A8%E6%9D%90。</p>
</aside>
</aside>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mass-spring.html"
       title="上一页">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">上一页</p>
        <p class="prev-next-title"><span class="section-number">21.1. </span>弹簧质点系统</p>
      </div>
    </a>
    <a class="right-next"
       href="summary.html"
       title="下一页">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">下一页</p>
        <p class="prev-next-title"><span class="section-number">21.3. </span>本章小结</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目录
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">21.2.1. 物理模型</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">21.2.1.1. 描述形变</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-energy">21.2.1.2. 描述能量</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-force">21.2.1.3. 描述力</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-energy-force">21.2.1.4. 能量与力的关系</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-models">21.2.1.5. 常见超弹性模型</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">21.2.1.5.1. 线性模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">21.2.1.5.2. 圣维南-基尔霍夫模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">21.2.1.5.3. 共旋转线性模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">21.2.1.5.4. 新胡克模型</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">21.2.1.5.5. 各种本构模型的比较</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-discretization">21.2.2. 空间离散化</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">21.2.2.1. 变形函数的选择</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">21.2.2.2. 形变梯度的计算</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">21.2.2.3. 能量与力的计算</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">21.2.3. 数值求解算法</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-animation-elastomers-fem-explicit-euler">21.2.3.1. 显式时间积分</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">21.2.3.2. 隐式时间积分</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
作者： 北京大学可视计算与学习实验室
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, 北京大学可视计算与学习实验室.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>